Type.registerNamespace("Mscrm");Mscrm.RequiredElementsMask=function(){};Mscrm.RequiredElementsMask.prototype={none:0,grid:1,chart:2,all:3};Mscrm.RequiredElementsMask.registerEnum("Mscrm.RequiredElementsMask",false);Mscrm.CompositeControl=function(element){Mscrm.CompositeControl.initializeBase(this,[element])};Mscrm.CompositeControl.mouseAction=function(domEvent,action,id){var $v_0=$find(id),$v_1=$find($v_0.$0_3+"_splitTD");if(!IsNull($v_1))switch(action){case "0":$v_1.onMouseMove(domEvent);break;case "1":$v_1.onMouseDown(domEvent);break;case "2":$v_1.onMouseUp(domEvent);break;default:break}};Mscrm.CompositeControl.glowGridStrip=function(on,controlId){var $v_0=$find(controlId),$v_1=Mscrm.CompositeControlUtil.findElementByGridId($v_0.$0_3,"gridStripDiv");if(on)$v_1.className="ms-crm-control-SideStrip-Hovered";else $v_1.className="ms-crm-control-SideStrip"};Mscrm.CompositeControl.glowPaneStrip=function(on,controlId){var $v_0=$find(controlId),$v_1=Mscrm.CompositeControlUtil.findElementByGridId($v_0.$0_3,"paneStripDiv");Mscrm.Utilities.glowBackground(on,$v_1,"ms-crm-control-SideStrip-Hovered","ms-crm-control-SideStrip")};Mscrm.CompositeControl.prototype={$0_3:"crmGrid",$9_3:null,initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);if(!isNullOrEmptyString(this.getParameter("gridid")))this.$0_3=this.getParameter("gridid");else this.$0_3="crmGrid";this.$T_3()},handleEvent:function(eventCode,parameters,sourceComponent){switch(eventCode){case Mscrm.ScriptEvents.OnGridRefresh:sourceComponent.get_id()===this.$0_3&&this.$e_3(parameters);break;case Mscrm.ScriptEvents.OnGridReset:sourceComponent.get_id()===this.$0_3&&this.$f_3(parameters);break;case Mscrm.ScriptEvents.OnGridResetComplete:sourceComponent.get_id()===this.$0_3&&this.$g_3(parameters);break;case Mscrm.ScriptEvents.OnDashboardRefresh:if(this.isGridEnabled()){IsNull(this.$9_3)&&this.$T_3();!IsNull(this.$9_3)&&this.$9_3.refresh()}else if(this.isChartEnabled()){var $v_1=$find(this.get_paneControlID());!IsNull($v_1)&&$v_1.refreshVisualizationPane(null)}break;case Mscrm.ScriptEvents.TabExpended:var $v_0=parameters["id"];if(!IsNull($v_0)&&$v_0===this.$0_3)if(this.isChartEnabled()){var $v_2=$find(this.get_paneControlID());!IsNull($v_2)&&$v_2.refreshVisualizationPane(null)}break;case Mscrm.ScriptEvents.PageLoaded:if(sourceComponent===$find(sourceComponent.get_id())&&this.isChartEnabled()){var $v_3=$find(this.get_paneControlID());if(!IsNull($v_3)){if(!IsNull(this.$9_3)){var $v_4=this.$9_3.GetParameter("isGridHidden")==="true",$v_5=this.$9_3.GetParameter("subgridAutoExpand")==="1";if(!$v_5&&$v_4){var $v_6=$get(this.$0_3+"_span");if(!IsNull($v_6)){var $v_7=$v_6.parentNode;if(!IsNull($v_7)&&$v_7.offsetHeight>0){var $v_8=parseInt(XUI.Html.GetComputedStyle($v_7,"paddingTop"),10);if(isNaN($v_8)||$v_8<0)$v_8=0;var $v_9=parseInt(XUI.Html.GetComputedStyle($v_7,"paddingBottom"),10);if(isNaN($v_9)||$v_9<0)$v_9=0;var $v_A=$v_7.offsetHeight-$v_8-$v_9;if($v_A<0)$v_A=0;$v_6.style.height=$v_A+"px"}}}}$v_3.handlePageLoad()}}break;case Mscrm.ScriptEvents.SetRibbonSelectedControl:var $v_B=parameters["selectedControl"],$v_C=$find(this.get_paneControlID());if(!IsNull($v_C)&&$v_C.isEnlargePaneOpen())break;if(!IsNull($v_B)&&($v_B.get_id()===this.get_id()||Mscrm.Utilities.isDescendant($v_B.get_element(),this.get_element()))){this.$b_3();if(!IsNull($v_C)){$v_C.unRegisterToolBarHandler();$v_C.showToolBar(Mscrm.ToolBarMode.topFit,$v_C.fadeInAnimator)}}else{this.$j_3();if(!IsNull($v_C)){$v_C.hideToolBarWithAnimation(null,$v_C.fadeOutAnimator);$v_C.registerToolBarHandler()}}break}return Mscrm.CrmUIControl.prototype.handleEvent.call(this,eventCode,parameters,sourceComponent)},$T_3:function(){var $v_0=$find(this.$0_3);if(!IsNull($v_0))this.$9_3=$v_0},$b_3:function(){var $v_0=$get(this.$0_3+"_span");if(IsNull($v_0))return;var $v_1=$v_0.children[0];if(!IsNull($v_1)&&Sys.UI.DomElement.containsCssClass($v_1,"ms-crm-Form-SubGrid-Layout")){Sys.UI.DomElement.removeCssClass($v_1,"ms-crm-Form-SubGrid-Layout");Sys.UI.DomElement.addCssClass($v_1,"ms-crm-Form-Chart-Layout-Selected");var $v_2=$v_1.getElementsByTagName("tr")[0];Sys.UI.DomElement.addCssClass($v_2,"ms-crm-Form-SubGrid-viewRow")}},$j_3:function(){var $v_0=$get(this.$0_3+"_span").children[0];if($v_0&&Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-Form-Chart-Layout-Selected")){Sys.UI.DomElement.removeCssClass($v_0,"ms-crm-Form-Chart-Layout-Selected");Sys.UI.DomElement.addCssClass($v_0,"ms-crm-Form-SubGrid-Layout");var $v_1=$v_0.getElementsByTagName("tr")[0];Sys.UI.DomElement.removeCssClass($v_1,"ms-crm-Form-SubGrid-viewRow")}},get_paneControlID:function(){return this.$0_3+"_paneControl"},$e_3:function($p0){var $v_0=$find(this.get_paneControlID());if(!IsNull($v_0))if(!IsNull($p0["gridRefreshSourceElement"])&&$p0["gridRefreshSourceElement"]==="filter")$v_0.handleGridRefresh(false);else $v_0.handleGridRefresh(true)},$f_3:function($p0){var $v_0=$find(this.get_paneControlID());!IsNull($v_0)&&$v_0.handleGridReset($p0)},$g_3:function($p0){var $v_0=$find(this.$0_3+"splitTD");!IsNull($v_0)&&$v_0.setViewLabelDisplayName();var $v_1=$find(this.get_paneControlID());!IsNull($v_1)&&$v_1.handleGridResetComplete($p0)},getParameter:function(name){var $v_0=$get("compositeControlParams",this.get_element());if($v_0){var $v_1=$get(name,$v_0);if($v_1)return CrmEncodeDecode.CrmHtmlDecode($v_1.getAttribute("value").toString())}return null},isOutlookControlProxy:function(){var $v_0=this.getParameter("isOutlookControlProxy");if(!$v_0||!$v_0.length)return false;return Boolean.parse($v_0)},isChartEnabled:function(){var $v_0=this.getParameter("elementsMask");if((Mscrm.RequiredElements.getRequiredElementsMask($v_0)&2)===2)return true;return false},isGridEnabled:function(){var $v_0=this.getParameter("elementsMask");if((Mscrm.RequiredElements.getRequiredElementsMask($v_0)&1)===1)return true;return this.isOutlookControlProxy()},getVisualizationPaneParameter:function(parameterName){var $v_0=this.$0_3+"_paneControl",$v_1=$get($v_0,this.get_element());if(!IsNull($v_1)){var $v_2=$get(parameterName,$v_1);if(!IsNull($v_2))return CrmEncodeDecode.CrmHtmlDecode($v_2.getAttribute("value").toString())}return null},get_compositeLayout:function(){var $v_0=this.getVisualizationPaneParameter("compositeLayout");return IsNull($v_0)?"0":$v_0},enableChartButton:function(){if(!this.isChartEnabled()||!this.isGridEnabled()||this.getParameter("ispreviewmode")==="true")return false;return true},showVisualization:function(toggleVisualization){var $v_0=$find(this.get_paneControlID());if(IsNull($v_0)){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_controls/pane/visualizationpane.js"),true);$create(Mscrm.VisualizationPane,null,null,null,$get(this.get_paneControlID()));$v_0=$find(this.get_paneControlID())}var $v_1=$v_0;if(!IsNull($v_1)){var $v_2=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"divDataArea");if($v_2&&$v_2.getAttribute("expandable").toString()==="1"&&$v_1.isVisualizationLayoutLeftRight()){var $v_3=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"crmGridTD").clientHeight;Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"compositeControl").style.height=$v_3+"px"}if(IsNull(toggleVisualization))toggleVisualization=true;$v_1.showVisualization(toggleVisualization)}},hideVisualization:function(){var $v_0=$find(this.get_paneControlID());if(IsNull($v_0)){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_controls/pane/visualizationpane.js"),true);$create(Mscrm.VisualizationPane,null,null,null,$get(this.get_paneControlID()));$v_0=$find(this.get_paneControlID())}var $v_1=$v_0;if(!IsNull($v_1)){var $v_2=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"divDataArea");if($v_2&&$v_2.getAttribute("expandable").toString()==="1"&&$v_1.isVisualizationLayoutLeftRight()){var $v_3=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"crmGridTD").clientHeight;Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"compositeControl").style.height=$v_3+"px"}$v_1.disableVisualization()}},handleEntityChange:function(entityLogicalName,selectedVisualizationId){var $v_0=$find(this.get_paneControlID());if(IsNull($v_0))try{var $v_1=$get(this.get_paneControlID()),$v_2=$get("vizPanePrimaryEntityName",$v_1);$v_2.setAttribute("value",entityLogicalName)}catch($v_3){if(!($v_3.name==="TypeError"))throw $v_3}else{var $v_4=$v_0;!IsNull($v_4)&&$v_4.handleEntityChange(entityLogicalName,selectedVisualizationId)}},get_entityTypeCode:function(){return 0},get_entityTypeName:function(){return null},get_recordCount:function(){return 0},get_selectedRecordCount:function(){return 0},get_ribbonContextType:function(){return null},get_ribbonRelationshipType:function(){return 0},get_allRecordIds:function(){return []},get_allRecords:function(){return []},get_selectedIds:function(){return []},get_selectedRecords:function(){return []},get_unselectedIds:function(){return []},get_unselectedRecords:function(){return []}};Mscrm.RequiredElements=function(){};Mscrm.RequiredElements.getRequiredElementsMask=function(mode){if(mode==="Grid")return 1;else if(mode==="Chart")return 2;else if(mode==="All")return 3;else return 0};Mscrm.CompositeControlForOutlook=function(e){Mscrm.CompositeControlForOutlook.initializeBase(this,[e])};Mscrm.CompositeControlForOutlook.prototype={showVisualization:function(){var $v_0=$find(this.get_paneControlID()),$v_1=IsNull($v_0)||!$v_0.isVisualizationPaneVisible();getOutlookHostedWindow().showVisualization($v_1);Mscrm.CompositeControl.prototype.showVisualization.call(this)},hideVisualization:function(){Mscrm.CompositeControl.prototype.hideVisualization.call(this);var $v_0=$find(this.get_paneControlID()),$v_1=IsNull($v_0)||!$v_0.isVisualizationPaneVisible();$v_1&&getOutlookHostedWindow().showVisualization(false)},handleEvent:function(eventCode,parameters,sourceComponent){switch(eventCode){case Mscrm.ScriptEvents.Navigate:getOutlookHostedWindow().handleEvent(eventCode,parameters["uri"],sourceComponent.get_id());break;case Mscrm.ScriptEvents.RibbonRefresh:getOutlookHostedWindow().handleEvent(eventCode,null,null);break}return Mscrm.CompositeControl.prototype.handleEvent.call(this,eventCode,parameters,sourceComponent)}};Mscrm.CompositeControlResizeControl=function(element){this.$$d_$Z_3=Function.createDelegate(this,this.$Z_3);this.$$d_onMouseUp=Function.createDelegate(this,this.onMouseUp);this.$$d_onMouseMove=Function.createDelegate(this,this.onMouseMove);this.$$d_$m_3=Function.createDelegate(this,this.$m_3);this.$$d_showGrid=Function.createDelegate(this,this.showGrid);this.$$d_$X_3=Function.createDelegate(this,this.$X_3);this.$$d_$i_3=Function.createDelegate(this,this.$i_3);this.$D_3="All";Mscrm.CompositeControlResizeControl.initializeBase(this,[element])};Mscrm.CompositeControlResizeControl.prototype={initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.$0_3=!isNullOrEmptyString(this.get_element().getAttribute("gridId"))?this.get_element().getAttribute("gridId"):"crmGrid";this.$6_3=!isNullOrEmptyString(this.get_element().getAttribute("layout"))?Number.parseInvariant(this.get_element().getAttribute("layout")):0;this.$1_3=this.get_element().getAttribute("panesize");this.$D_3=!IsNull(this.get_element().getAttribute("requiredElements"))?this.get_element().getAttribute("requiredElements"):"All";if(this.$D_3!=="All")return;var $v_0=null;if(!this.$6_3){$v_0=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/verticalGripper.gif"));this.get_element().innerHTML=String.format('<div class="ms-crm-IE7-Height-Fix-Dummy-Container"> <table cellspacing="0"  cellpadding="0" style="height:100%;cursor:col-resize;"><tr><td> <a style="cursor:col-resize;display:inline-block;" onkeypress="$find(\'{0}_splitTD\').togglePane_keypress(new Sys.UI.DomEvent(event));" href="javascript:void(0);"><img class=\'ms-crm-ImageStrip-verticalGripper {1}\'  style="cursor:col-resize" id="{0}_splitterImage" alt="" src=\'{2}\' /></a></td></tr></table></div>',this.$0_3,$v_0.cssClass,$v_0.source)}else{$v_0=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/horizontalGripper.gif"));this.get_element().innerHTML=String.format('<a style="cursor:row-resize;display:block;width:100%;height:100%"  onkeypress="$find(\'{0}_splitTD\').togglePane_keypress(new Sys.UI.DomEvent(event));" href="javascript:void(0);"><img class=\'ms-crm-ImageStrip-horizontalGripper {1}\'  style="position:absolute;top:-1px;left:48%;cursor:row-resize;" id="{0}_splitterImage" alt="" src=\'{2}\' /></a>',this.$0_3,$v_0.cssClass,$v_0.source)}$addHandler(window,"resize",this.$$d_$i_3);window.setTimeout(this.$$d_$X_3,0)},hideVisualizationPane:function(){if(this.$1_3!==Mscrm.VisualizationPaneMode.collapsedSize){this.$P_3=this.$1_3;if(!IsNull(this.get_$3_3()))if(!this.$6_3)this.$E_3=this.get_$3_3().offsetWidth/this.get_$3_3().parentNode.offsetWidth;else this.$E_3=this.get_$3_3().offsetHeight/this.get_$3_3().parentNode.offsetHeight;this.$1_3=Mscrm.VisualizationPaneMode.collapsedSize;this.$B_3();refreshRibbon()}Mscrm.PageManager.isOutlookProxyPage()&&getOutlookHostedWindow().showVisualizationCollapsed(true)},showVisualizationPane:function(){if(IsNull(this.get_$4_3()))return;if(this.$1_3===Mscrm.VisualizationPaneMode.collapsedSize||this.$1_3===Mscrm.VisualizationPaneMode.none)switch(this.$P_3){case Mscrm.VisualizationPaneMode.expandedSize:this.togglePaneSize();break;case Mscrm.VisualizationPaneMode.resizeMode:if(!IsNull(this.get_$3_3())){this.$1_3=Mscrm.VisualizationPaneMode.resizeMode;this.$B_3(this.$Q_3(this.$E_3))}break;default:this.$1_3=Mscrm.VisualizationPaneMode.defaultSize;this.$B_3();break}},disableVisualizationPane:function(){this.$1_3=Mscrm.VisualizationPaneMode.none;this.$B_3()},$i_3:function($p0){this.$X_3()},$X_3:function(){if(this.$1_3!=="1"&&this.$1_3!=="3")return;this.$B_3(this.$Q_3(this.$E_3))},$Q_3:function($p0){if(!$p0)$p0=!this.$6_3?.68:.5;return Math.round(!this.$6_3?this.get_element().parentNode.offsetWidth-$p0*this.get_element().parentNode.offsetWidth:this.get_element().parentNode.offsetHeight-$p0*this.get_element().parentNode.offsetHeight)},showGrid:function(){if(this.$1_3!==Mscrm.VisualizationPaneMode.defaultSize){this.$1_3=Mscrm.VisualizationPaneMode.defaultSize;this.$B_3();this.get_$4_3().get_paneMode()===Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.$G_3(this.get_$4_3().checkIfDrilldownMode())}},sideStrip_Click:function(grid){if(Boolean.parse(grid))window.setTimeout(this.$$d_showGrid,500);else{window.setTimeout(this.$$d_$m_3,500);var $$t_1=this.get_$4_3();window.setTimeout($$t_1.$$d_setFocusOnVizPane||($$t_1.$$d_setFocusOnVizPane=Function.createDelegate($$t_1,$$t_1.setFocusOnVizPane)),600)}},$m_3:function(){this.get_$4_3().showVisualizationPane()},togglePane_keypress:function(domEvent){var $v_0=Mscrm.Utilities.getDomEventKeyCode(domEvent);$v_0===13&&this.togglePaneSize()},togglePaneSize:function(){var $v_0=this.get_$4_3().checkIfDrilldownMode();if(this.get_$4_3().get_isChartStale())$v_0=false;if(this.$1_3!==Mscrm.VisualizationPaneMode.expandedSize){this.$1_3=Mscrm.VisualizationPaneMode.expandedSize;this.$B_3();this.setViewLabelDisplayName();this.get_$4_3().get_paneMode()===Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.$G_3($v_0)}else{this.$1_3=Mscrm.VisualizationPaneMode.defaultSize;this.$B_3();this.get_$4_3().get_paneMode()===Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.$G_3($v_0)}},$Z_3:function($p0){!IsNull(this.$2_3)&&this.$N_3(this.$2_3.contentWindow.document)},$N_3:function($p0){var $v_0=$p0;$addHandler($v_0,"mousemove",this.$$d_onMouseMove);$addHandler($v_0,"mouseup",this.$$d_onMouseUp)},$S_3:function($p0){var $v_0=$p0;$removeHandler($v_0,"mousemove",this.$$d_onMouseMove);$removeHandler($v_0,"mouseup",this.$$d_onMouseUp)},onMouseMove:function(domEvent){if(!this.$H_3)return;else{var $v_0=0;if(!this.$6_3){var $v_1=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"splitTD"),$v_2=Mscrm.Utilities.getXYPos($v_1,window.LOCID_UI_DIR==="RTL");$v_0=$v_2["x"]+(domEvent.screenX-this.$U_3)}else{var $v_3=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"splitTD"),$v_4=Mscrm.Utilities.getXYPos($v_3,window.LOCID_UI_DIR==="RTL");$v_0=$v_4["y"]+(domEvent.screenY-this.$V_3)}this.$Y_3($v_0)}},onMouseDown:function(domEvent){var $v_0=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"crmGridTD"),$v_1=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"splitTD"),$v_2=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"paneTD"),$v_3=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"crmGridStrip");if(this.$1_3===Mscrm.VisualizationPaneMode.none)return;else{this.$H_3=true;if(!this.$6_3){$v_0.style.cursor="col-resize";this.$8_3=domEvent.clientX;if(window.LOCID_UI_DIR==="RTL"){if($v_0.style.display==="none")this.$C_3=$v_0.parentNode.clientWidth-$v_3.clientWidth;else this.$C_3=this.$8_3+$v_0.clientWidth-$v_1.clientWidth;this.$7_3=Math.round($v_0.parentNode.clientWidth*(1-.68));this.$7_3=Math.max(this.$7_3,340)}else{if($v_0.style.display==="none")this.$7_3=$v_3.offsetWidth+1;else this.$7_3=this.$8_3-$v_0.clientWidth+$v_1.clientWidth;this.$C_3=Math.round(this.$8_3+$v_2.clientWidth-Math.max($v_0.parentNode.clientWidth*(1-.68),340))}}else{$v_0.style.cursor="row-resize";var $v_5=Mscrm.Utilities.getXYPos($v_0.parentNode,window.LOCID_UI_DIR==="RTL");this.$7_3=$v_5["y"]+Math.round($v_0.parentNode.clientHeight*(1-.5));this.$C_3=$v_5["y"]+$v_0.parentNode.clientHeight;this.$8_3=domEvent.clientY}this.$l_3();this.$U_3=domEvent.screenX;this.$V_3=domEvent.screenY;this.$N_3(window.document);var $v_4=$get(this.$0_3+"_vizIframe");!IsNull($v_4)&&this.$N_3($v_4.contentWindow.document);domEvent.preventDefault()}},onMouseUp:function(domEvent){this.$S_3(window.document);var $v_0=$get(this.$0_3+"_vizIframe");!IsNull($v_0)&&this.$S_3($v_0.contentWindow.document);var $v_1=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"crmGridTD");if(this.$H_3)if(this.$1_3===Mscrm.VisualizationPaneMode.none)return;else{this.$H_3=false;$v_1.style.cursor="default";var $v_2=0;if(!this.$6_3)$v_2=this.$2_3.offsetLeft+this.$2_3.offsetWidth;else $v_2=this.$2_3.offsetTop+this.$2_3.offsetHeight;this.$h_3();if(this.$8_3>=$v_2-10&&this.$8_3<=$v_2+10)return;var $v_3=0;if(!this.$6_3)$v_3=window.LOCID_UI_DIR==="RTL"?this.$C_3:this.$7_3;var $v_4=0;if($v_2>=this.$7_3&&$v_2<=this.$C_3)$v_4=$v_2-$v_3;else if($v_2<this.$7_3)$v_4=this.$7_3-$v_3;else $v_4=this.$C_3-$v_3;if(!this.$6_3&&window.LOCID_UI_DIR==="RTL")$v_4=-$v_4;this.$k_3($v_4)}},$l_3:function(){IsNull(this.$2_3)&&this.$a_3();var $v_0=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"splitTD"),$v_1=Mscrm.Utilities.getXYPos($v_0,window.LOCID_UI_DIR==="RTL");this.$2_3.style.top=$v_1["y"].toString()+"px";this.$2_3.style.left=$v_1["x"].toString()+"px";this.$2_3.style.width=$v_0.offsetWidth.toString()+"px";this.$2_3.style.height=$v_0.offsetHeight.toString()+"px";this.$Y_3(this.$8_3);this.$2_3.style.display="inline"},$Y_3:function($p0){if(!IsNull(this.$2_3)){var $v_0=$p0;if($p0<this.$7_3)$v_0=this.$7_3;else if($p0>this.$C_3)$v_0=this.$C_3;if(!this.$6_3)this.$2_3.style.left=$v_0.toString()+"px";else this.$2_3.style.top=$v_0.toString()+"px"}},$h_3:function(){if(!IsNull(this.$2_3)){this.$2_3.style.display="none";this.$2_3.style.height="";this.$2_3.style.width="";this.$2_3.style.left="";this.$2_3.style.top=""}},$k_3:function($p0){if(this.$8_3>=$p0-10&&this.$8_3<=$p0+10)return;var $v_0=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"crmGridTD");if(!this.$6_3){if($p0<=30){this.$1_3!==Mscrm.VisualizationPaneMode.expandedSize&&this.togglePaneSize();return}this.$E_3=$p0/this.get_$3_3().parentNode.offsetWidth}else{if($v_0.parentNode.clientHeight-$p0<=30){this.$1_3!==Mscrm.VisualizationPaneMode.expandedSize&&this.togglePaneSize();return}$p0=$v_0.clientHeight+(this.$8_3-$p0);if($p0<0)$p0=0;this.$E_3=$p0/this.get_$3_3().parentNode.offsetHeight}this.$1_3=Mscrm.VisualizationPaneMode.resizeMode;this.$B_3(!this.$6_3?this.get_$5_3().parentNode.offsetWidth-$p0:this.get_$5_3().parentNode.offsetHeight-$p0);this.$O_3();this.get_$4_3().get_paneMode()===Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.$G_3(this.get_$4_3().checkIfDrilldownMode())},$a_3:function(){if(IsNull(this.$2_3)){var $v_0=document.createElement("iframe");$v_0.id="paneSplitter_backFrame";$v_0.style.position="fixed";$v_0.style.display="none";$v_0.frameBorder="0";$v_0.style.zIndex=99;var $v_1=Mscrm.CrmUri.create("/_static/PaneSplitter.htm");$v_0.src=$v_1.toString();document.body.appendChild($v_0);this.$2_3=$get("paneSplitter_backFrame");$addHandler(this.$2_3.contentWindow,"load",this.$$d_$Z_3)}},$G_3:function($p0){if(IsNull(this.get_$4_3()))return;this.get_$4_3().loadVisualizationsForCurrentViewIfNotLoaded();var $v_0=this.get_$4_3().get_useCachedData();!$p0&&this.get_$4_3().set_useCachedData(true);try{this.get_$4_3().cancelDrillDownAndLoadVisualization($p0)}finally{this.get_$4_3().set_useCachedData($v_0)}},setViewLabelDisplayName:function(){var $v_0=Mscrm.CompositeControlUtil.findElementByGridId(this.$0_3,"GridStripLabelMessage");if(!IsNull(this.get_$F_3())&&!IsNull($v_0)&&this.$1_3===Mscrm.VisualizationPaneMode.expandedSize){var $v_1=String.format(window.LOCID_VP_COLLAPSED_VIEW_NAME,this.get_$F_3().get_entityDisplayPluralName(),this.get_$F_3().get_viewTitle());$v_0.innerHTML=CrmEncodeDecode.CrmHtmlEncode($v_1);$v_0.title=$v_1}},$c_3:function(){if(this.$1_3===Mscrm.VisualizationPaneMode.resizeMode)this.$1_3=Mscrm.VisualizationPaneMode.defaultSize;var $v_0=Mscrm.VisualizationActions.createVizParamsDictionary(this.$d_3(),this.get_$4_3().get_visualizationId(),this.get_$4_3().get_visualizationType().toString(),this.$1_3.toString(),this.get_$4_3().getParameter("vizPanePrimaryEntityName"),this.get_$4_3().getParameter("IsDashboardComponent"));this.get_$4_3().set_paneSize(this.$1_3);Mscrm.VisualizationActions.fireEventForStickyVisualization($v_0)},$d_3:function(){if(this.$6_3===1)return "1";else return "0"},$B_3:function($p0){if(IsNull($p0))$p0=0;var $v_0=!this.$6_3?this.get_element().parentNode.offsetWidth:this.get_element().parentNode.offsetHeight;switch(this.$1_3){case Mscrm.VisualizationPaneMode.resizeMode:case Mscrm.VisualizationPaneMode.defaultSize:this.$A_3(this.get_$5_3(),"pane");this.$A_3(this.get_$W_3(),"PaneSS");this.$A_3(this.get_$3_3(),"grid");this.$A_3(this.get_$R_3(),"GridSS");this.$A_3(this.get_element(),"splitter");Sys.UI.DomElement.addCssClass(this.get_element(),"ms-crm-CC-splitter");if(this.$D_3==="All")if(!this.$6_3){if(!$p0)$p0=Math.round($v_0-$v_0*.68);$p0=Math.max($p0,340);if(window.LOCID_UI_DIR!=="RTL"){this.get_$3_3().style.right=$p0.toString()+"px";this.get_$3_3().style.width="auto";this.get_$3_3().style.left="";this.get_$5_3().style.left="";this.get_$5_3().style.right="0px";this.get_$5_3().style.width=($p0-3).toString()+"px";this.get_element().style.right=($p0-3).toString()+"px"}else{this.get_$3_3().style.left=$p0.toString()+"px";this.get_$3_3().style.width="auto";this.get_$3_3().style.right="";this.get_$5_3().style.right="";this.get_$5_3().style.left="0px";this.get_$5_3().style.width=($p0-3).toString()+"px";this.get_element().style.left=($p0-3).toString()+"px"}}else{if(!$p0)$p0=Math.round($v_0-$v_0*.5);this.get_$3_3().style.top=$p0.toString()+"px";this.get_$3_3().style.bottom="";this.get_$5_3().style.bottom="";this.get_$5_3().style.top="0px";this.get_$5_3().style.height=($p0-3).toString()+"px";this.get_element().style.top=($p0-3).toString()+"px"}this.$O_3();break;case Mscrm.VisualizationPaneMode.collapsedSize:case Mscrm.VisualizationPaneMode.expandedSize:default:if(this.$D_3==="All")if(!this.$6_3){this.get_$5_3().style.left="";this.get_$5_3().style.right="";this.get_$3_3().style.left="";this.get_$3_3().style.right="";this.get_$5_3().style.width="";if(window.LOCID_UI_DIR!=="RTL")this.get_element().style.right="";else this.get_element().style.left=""}else{this.get_$5_3().style.bottom="";this.get_$5_3().style.top="";this.get_$3_3().style.bottom="";this.get_$3_3().style.top="";this.get_$5_3().style.height="";this.get_element().style.top=""}this.$A_3(this.get_$5_3(),"pane");this.$A_3(this.get_$W_3(),"PaneSS");this.$A_3(this.get_$3_3(),"grid");this.$A_3(this.get_$R_3(),"GridSS");this.$A_3(this.get_element(),"splitter");Sys.UI.DomElement.addCssClass(this.get_element(),"ms-crm-CC-splitter");this.$O_3();break}this.$c_3()},$A_3:function($p0,$p1){if(IsNull($p0))return;var $v_0=!this.$6_3?"LR":"TB";$p0.className=String.format("ms-crm-CC-{0}-{1}-{2}-{3}",$p1,this.$D_3,this.$1_3,$v_0)},$O_3:function(){!IsNull(this.get_$F_3())&&!IsNull(this.get_$F_3().HandleGridResize)&&this.get_$F_3().HandleGridResize()},get_$F_3:function(){if(IsNull(this.$9_3))this.$9_3=$find(this.$0_3);return this.$9_3},get_$4_3:function(){if(IsNull(this.$L_3))this.$L_3=$find(this.$0_3+"_paneControl");return this.$L_3},get_$R_3:function(){if(IsNull(this.$J_3))this.$J_3=$get(this.$0_3+"_crmGridStrip");return this.$J_3},get_$3_3:function(){if(IsNull(this.$I_3))this.$I_3=$get(this.$0_3+"_crmGridTD");return this.$I_3},get_$5_3:function(){if(IsNull(this.$K_3))this.$K_3=$get(this.$0_3+"_paneTD");return this.$K_3},get_$W_3:function(){if(IsNull(this.$M_3))this.$M_3=$get(this.$0_3+"_crmVisualizationPaneStrip");return this.$M_3},get_mode:function(){return this.$1_3},set_mode:function(value){this.$1_3=value;return value},dispose:function(){!IsNull(this.$D_3)&&this.$D_3==="All"&&$removeHandler(window,"resize",this.$$d_$i_3);Mscrm.CrmUIControl.prototype.dispose.call(this)},$6_3:0,$I_3:null,$K_3:null,$M_3:null,$J_3:null,$1_3:null,$P_3:null,$E_3:0,$L_3:null,$2_3:null,$9_3:null,$0_3:"crmGrid",$H_3:false,$8_3:0,$7_3:1,$C_3:800,$U_3:0,$V_3:0};Mscrm.CompositeControl.registerClass("Mscrm.CompositeControl",Mscrm.CrmUIControl,Mscrm.IRibbonSelectionControl);Mscrm.RequiredElements.registerClass("Mscrm.RequiredElements");Mscrm.CompositeControlForOutlook.registerClass("Mscrm.CompositeControlForOutlook",Mscrm.CompositeControl);Mscrm.CompositeControlResizeControl.registerClass("Mscrm.CompositeControlResizeControl",Mscrm.CrmUIControl);Mscrm.RequiredElements.grid="Grid";Mscrm.RequiredElements.chart="Chart";Mscrm.RequiredElements.all="All"