Type.registerNamespace("Mscrm");Mscrm.ExportDialogArguments=function(){};Mscrm.ExportDialogReturnValue=function(){};Mscrm.ExportDialogResult=function(){};Mscrm.ExportDialogResult.prototype={cancel:-1,currentPage:0,allPages:1,liveList:2,livePivot:3};Mscrm.ExportDialogResult.registerEnum("Mscrm.ExportDialogResult",false);Mscrm.DetectDuplicateArguments=function(){};Mscrm.ReportResult=function(){};Mscrm.ReportResult.prototype={cancel:-1,selected:0,view:1,defaultResult:2};Mscrm.ReportResult.registerEnum("Mscrm.ReportResult",false);Mscrm.TeamActions=function(){};Mscrm.TeamActions.addTeamMembers=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("addtoteam",entityTypeCode,records.length),$v_1=400,$v_2=200;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.TeamActions.removeTeamMembers=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("removefromteam",entityTypeCode,records.length),$v_1=400,$v_2=200;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.TeamActions.manageTeamRoles=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("role",entityTypeCode,records.length),$v_1=500,$v_2=330;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.UserQueryActions=function(){};Mscrm.UserQueryActions.filterGridByType=function(gridControl,commandProperties){if(!commandProperties)return;var $v_0=commandProperties["SourceControlId"];Mscrm.UserQueryActions.changeViewTitle(Mscrm.UserQueryActions.$b($v_0));var $v_1=$v_0.split(".");Mscrm.UserQueryActions._queryTargetTypeCode=Number.parseInvariant($v_1[$v_1.length-1]);Mscrm.UserQueryActions.refreshGrid(gridControl)};Mscrm.UserQueryActions.$b=function($p0){var $v_0=XUI.Xml.SelectSingleNode(Mscrm.UserQueryActions.get_$D(),"/Menu/MenuSection/Controls/Button[@Id='"+$p0+"']",null),$v_1="";if(!IsNull($v_0))$v_1=$v_0.attributes.getNamedItem("LabelText").nodeValue;return $v_1};Mscrm.UserQueryActions.refreshGrid=function(gridControl){gridControl.SetParameter("returnedtypecode",Mscrm.UserQueryActions._queryTargetTypeCode.toString(10));gridControl.SetParameter("customquery","FilterByObjectType");var $v_0=$get(gridControl.get_id()+"_SavedNewQuerySelector");if($v_0.nodeValue===window.LOCID_SEARCH_RESULTS)quickFind(gridControl);else handleView(null,gridControl)};Mscrm.UserQueryActions.setEntityDefaultView=function(selectedRecords){try{var $v_0=selectedRecords[0];setDefaultEntityView(Mscrm.UserQueryActions._queryTargetTypeCode,$v_0.Id,$v_0.TypeCode)}catch($$e_2){}};Mscrm.UserQueryActions.populateRecordType=function(commandProperties){if(!IsNull(Mscrm.UserQueryActions.get_$D())){commandProperties["PopulationXML"]=XUI.Xml.XMLSerializer.serializeToString(Mscrm.UserQueryActions.get_$D());commandProperties["SuppressCommandIncludes"]=true}};Mscrm.UserQueryActions.get_$D=function(){if(IsNull(Mscrm.UserQueryActions.$7)){var $v_0="userquery",$v_1="userquery|NoRelationship|SubGridStandard|Mscrm.SubGrid.userquery.MainTab.View.RecordType",$v_2=new RemoteCommand("AdvancedFind","GenerateRecordTypeMenuXml");$v_2.SetParameter("entityLogicalName",$v_0);$v_2.SetParameter("menuId",$v_1);var $v_3=$v_2.Execute();if($v_3.Success)Mscrm.UserQueryActions.$7=XUI.Xml.LoadXml($v_3.ReturnValue)}return Mscrm.UserQueryActions.$7};Mscrm.UserQueryActions.changeViewTitle=function(entityName){var $v_0=String.format(window.LOCID_AF_SVDVIEWTITLE,entityName),$v_1=$get("userQueries"),$v_2=$get("newViewSelector",$v_1);Sys.UI.DomElement.removeCssClass($v_2,"ms-crm-View-Entity-OverflowName");$v_2.style.width="";$v_2.innerHTML=CrmEncodeDecode.CrmHtmlEncode($v_0);$v_2.title=$v_0;var $v_3=$get("viewSelectorContainer").clientWidth/2,$v_4=$v_2.clientWidth;$v_4=$v_4<$v_3?$v_4:$v_3;$v_4=$v_4?$v_4:50;Sys.UI.DomElement.addCssClass($v_2,"ms-crm-View-Entity-OverflowName");$v_2.style.width=$v_4.toString()+"px"};Mscrm.Campaign=function(){};Mscrm.Campaign.newTemplate=function(){openObjEx(Mscrm.EntityTypeCode.Campaign,Mscrm.EntityTypeCode.None,null,"?template=1",null)};Mscrm.Campaign.copyCampaign=function(campaignId,saveAsTemplate){var $v_0=new RemoteCommand("MarketingAutomation","CopyCampaign",null);$v_0.SetParameter("campaignId",campaignId);$v_0.SetParameter("saveAsTemplate",saveAsTemplate.toString());var $v_1=$v_0.Execute(),$v_2=$v_1.ReturnValue;openObj(Mscrm.EntityTypeCode.Campaign,$v_2,null,null,Mscrm.NavigationMode.NavigationModeInline,null);Mscrm.Utilities.refreshParentGrid(Mscrm.EntityTypeCode.Campaign,campaignId)};Mscrm.IncidentActions=function(){};Mscrm.IncidentActions.cancelCase=function(caseId,gridControl){var $v_0=[caseId,gridControl],$v_1=Mscrm.Utilities.createCallbackFunctionObject("performActionAfterCancelCase",Mscrm.IncidentActions,$v_0),$v_2=openStdDlgWithCallback(Mscrm.CrmUri.create("/CS/cases/dlg_cancel.aspx"),null,400,200,$v_1);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.IncidentActions.performActionAfterCancelCase($v_2,caseId,gridControl)};Mscrm.IncidentActions.performActionAfterCancelCase=function(returnValue,caseId,gridControl){if(returnValue){var $v_0=new RemoteCommand("CustomerService","CancelCase");$v_0.SetParameter("caseId",caseId);$v_0.SetParameter("newStatus",returnValue.StatusCode);$v_0.Execute();gridControl&&gridControl.refresh()}};Mscrm.IncidentActions.resolveCase=function(caseId,gridControl){Mscrm.FormAction.resolveCase(caseId,gridControl)};Mscrm.IncidentActions.caseFlow=function(activityTypeCode){var $v_0=Mscrm.CrmUri.create("/_forms/read/page.aspx");$v_0.get_query()["formid"]=Mscrm.IncidentActions.$E;$v_0.get_query()["activitytypecode"]=activityTypeCode;$v_0.get_query()["setlastviewed"]=false;var $v_1=Mscrm.CrmUri.create("/main.aspx");$v_1.get_query()["rof"]=true;openObj(Mscrm.EntityTypeCode.Incident,"",$v_0.get_queryString(),null,Mscrm.NavigationMode.DefaultNavigationMode,$v_1.get_query())};Mscrm.IncidentActions.isRefreshFormAccessible=function(){var $v_0=new RemoteCommand("CustomerService","IsRefreshFormAccessible");$v_0.SetParameter("formId",Mscrm.IncidentActions.$E);var $v_1=$v_0.Execute();return !!$v_1&&$v_1.ReturnValue};Mscrm.Article=function(){};Mscrm.Article.articleRibbonActions=function(gridControl,selectedRecords,entityTypeCode,action){var $v_0=Mscrm.GridRibbonActions.$0(action,entityTypeCode,selectedRecords.length),$v_1=400,$v_2=200;if(action==="articleview"){$v_0=Mscrm.CrmUri.create("/CS/articles/viewer/default.aspx");$v_0.get_query()["id"]=selectedRecords[0].Id;$v_1=650;$v_2=500}Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,$v_1,$v_2)};Mscrm.ImportFileActions=function(){};Mscrm.ImportFileActions.deleteAllRecordsForCurrentImportFile=function(gridControl,records,entityTypeCode){var $v_0="deleteimportedrecords";doAction(gridControl.get_id(),entityTypeCode,$v_0,null)};Mscrm.ImportFileActions.deleteAllRecordsForCurrentImport=function(gridControl,records,entityTypeCode){var $v_0="deleteallimportedrecords";doAction(gridControl.get_id(),entityTypeCode,$v_0,null)};Mscrm.List=function(){};Mscrm.List.copyTo=function(gridControl,records,entityTypeCode){var $v_0="copyto",$v_1=[gridControl,$v_0,entityTypeCode,records],$v_2=Mscrm.Utilities.createCallbackFunctionObject("takeAction",Mscrm.List,$v_1),$v_3=LookupObjectsWithCallback($v_2,null,"single","4300",0,null,"listType=static",1,1,false,"","","","577EA96E-B1F6-499b-98A7-ABB5BE8233F9",null,null,null,null,null,null,null,null,null);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.List.takeAction($v_3,gridControl,$v_0,entityTypeCode,records)};Mscrm.List.takeAction=function(lookupItems,gridControl,actionName,entityTypeCode,records){if(IsNull(lookupItems)||!lookupItems.items.length)return;var $v_0=lookupItems.items[0].id,$v_1=lookupItems.items[0].type,$v_2=Mscrm.GridRibbonActions.$0(actionName,entityTypeCode,records.length);$v_2.get_query()["itemObjectId"]=$v_0;$v_2.get_query()["itemObjectTypeCode"]=$v_1;Mscrm.GridRibbonActions.$1($v_2,gridControl,records,400,250)};Mscrm.List.addToCampaign=function(gridControl,records,entityTypeCode){var $v_0="addtocampaign",$v_1=[gridControl,$v_0,entityTypeCode,records],$v_2=Mscrm.Utilities.createCallbackFunctionObject("takeAction",Mscrm.List,$v_1),$v_3=LookupObjectsWithCallback($v_2,null,"single","4400",0,null,null,1,1,false,"","","","",null,null,null,null,null,null,null,null,null);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.List.takeAction($v_3,gridControl,$v_0,entityTypeCode,records)};Mscrm.List.manageMembers=function(gridControl,records,entityTypeCode,objectId,form){if(LIST_TYPE)OpenDynamicListQuery(entityTypeCode,gridControl.get_id(),objectId);else OpenManageMembersWizard(entityTypeCode,gridControl.get_id(),objectId,420,425)};Mscrm.List.manageMembersForm=function(form){var $v_0=$find("crmForm"),$v_1=form.getUnformattedValue("createdfromcode");if(form.getUnformattedValue("type"))OpenDynamicListQuery($v_1,null,$v_0.get_objectId());else OpenManageMembersWizard($v_1,null,$v_0.get_objectId(),420,425)};Mscrm.List.copyListMembers=function(gridControl,records,entityTypeCode,objectId){var $v_0="copylistmember";doAction(gridControl.get_id(),entityTypeCode,$v_0,"")};Mscrm.List.removeFromList=function(gridControl,records,entityTypeCode){var $v_0="delete",$v_1=4301;doActionEx(gridControl.get_id(),$v_1,window.parent.$get("crmFormSubmit").crmFormSubmitId.value,$v_0)};Mscrm.List.createOpportunityForMembers=function(gridControl,records,entityTypeCode){var $v_0="createopportunity";doActionEx(gridControl.get_id(),entityTypeCode,window.parent.$get("crmFormSubmit").crmFormSubmitId.value,$v_0)};Mscrm.List.convertLeadQuick=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.List.$J(true);Mscrm.List.performActionAfterConvertLead($v_0,gridControl,records,entityTypeCode)};Mscrm.List.convertLeadDisqualifyQuick=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.List.$J(false);Mscrm.List.performActionAfterConvertLead($v_0,gridControl,records,entityTypeCode)};Mscrm.List.convertQualifyAs=function(gridControl,records,entityTypeCode,statusCode){var $v_0=Mscrm.List.$K(true,statusCode);Mscrm.List.performActionAfterConvertLead($v_0,gridControl,records,entityTypeCode)};Mscrm.List.convertDisqualifyAs=function(gridControl,records,entityTypeCode,statusCode){var $v_0=Mscrm.List.$K(false,statusCode);Mscrm.List.performActionAfterConvertLead($v_0,gridControl,records,entityTypeCode)};Mscrm.List.$K=function($p0,$p1){var $v_0={};$v_0["sCustParams"]="&qualify="+$p0;$v_0["sCustParams"]+="&ulNewStatus="+$p1;$v_0["sCustParams"]+="&qlForSalesRefresh=true";$v_0["sCustParams"]+="&qlShowNew=false";$v_0["sCustParams"]+="&qlCreateAccount=false";$v_0["sCustParams"]+="&qlCreateContact=false";$v_0["sCustParams"]+="&qlCreateOpportunity=false";return $v_0};Mscrm.List.convertLead=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.CrmUri.create("/SFA/Leads/Dialogs/conv_lead.aspx");if(records&&records.length>1)$v_0.get_query()["showNew"]=0;var $v_1=[gridControl,records,entityTypeCode],$v_2=Mscrm.Utilities.createCallbackFunctionObject("performActionAfterConvertLead",Mscrm.List,$v_1),$v_3=openStdDlgWithCallback($v_0,null,410,430,$v_2);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.List.performActionAfterConvertLead($v_3,gridControl,records,entityTypeCode)};Mscrm.List.$J=function($p0){var $v_0={};$v_0["sCustParams"]="&qualify="+$p0;if(!$p0)$v_0["sCustParams"]+="&ulNewStatus="+Mscrm.LeadActions.getDisqualifyState();else $v_0["sCustParams"]+="&ulNewStatus="+Mscrm.LeadActions.getQualifyState();$v_0["sCustParams"]+="&qlForSalesRefresh=true";$v_0["sCustParams"]+="&qlShowNew=false";$v_0["sCustParams"]+="&qlCreateAccount=false";$v_0["sCustParams"]+="&qlCreateContact=false";$v_0["sCustParams"]+="&qlCreateOpportunity=false";return $v_0};Mscrm.List.performActionAfterConvertLead=function(resultValue,gridControl,records,entityTypeCode){if(resultValue){var $v_0="convertlead",$v_1=resultValue.sCustParams;if(!$v_1)$v_1="";else if($v_1.length>0&&$v_1.charAt(0)==="&")$v_1=$v_1.substr(1);var $v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_"+CrmEncodeDecode.CrmUrlEncode($v_0)+".aspx?"+$v_1);$v_2.get_query()["iObjType"]=entityTypeCode;$v_2.get_query()["iTotal"]=records.length;for(var $v_3=new Array(records.length),$v_7=0;$v_7<records.length;$v_7++)$v_3[$v_7]=records[$v_7].Id;var $v_4=[true,gridControl],$v_5=Mscrm.Utilities.createCallbackFunctionObject("performActionAfterConvertLeadConfirm",Mscrm.List,$v_4),$v_6=openStdDlgWithCallback($v_2,$v_3,400,200,$v_5);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.List.performActionAfterConvertLeadConfirm($v_6,true,gridControl)}};Mscrm.List.performActionAfterConvertLeadConfirm=function(openItemsScript,returnValue,gridControl){if(returnValue){gridControl&&gridControl.refresh();eval(openItemsScript)}};Mscrm.List.isLeadMemberType=function(entityTypeCode){if(entityTypeCode===4)return true;return false};Mscrm.List.isAccountOrContactMemberType=function(entityTypeCode){if(entityTypeCode===1||entityTypeCode===2)return true;return false};Mscrm.List.copyDynamicListToStatic=function(id){var $v_0=$find("crmForm");if($v_0.get_isDirty()){alert(window.LOCID_FORM_DIRTY);return}var $v_1=Mscrm.CrmUri.create("/MA/Lists/dlg_copytostatic.aspx"),$v_2=[id],$v_3=Mscrm.Utilities.createCallbackFunctionObject("copyDynamicListToStaticCallback",Mscrm.List,$v_2),$v_4=openStdDlgWithCallback($v_1,null,450,200,$v_3,true,false,null);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.List.copyDynamicListToStaticCallback($v_4,id)};Mscrm.List.copyDynamicListToStaticCallback=function(isCopy,id){if(isCopy){var $v_0=new RemoteCommand("MarketingAutomation","CopyDynamicListToStatic",null);$v_0.SetParameter("listId",id);var $v_1=$v_0.Execute(),$v_2=$v_1.ReturnValue;openObj(Mscrm.EntityTypeCode.List,$v_2,null,null,Mscrm.NavigationMode.NavigationModeInline,null);Mscrm.Utilities.refreshParentGrid(Mscrm.EntityTypeCode.List,id)}};Mscrm.List.isACLFormAndOffline=function(gridTypeCode,gridControl){var $v_0=true;if(!Mscrm.SessionInfo.isOnline()){var $v_1=gridControl.GetParameter("relName");if(gridTypeCode===Mscrm.EntityTypeCode.List)switch($v_1){case "listlead_association":case "listcontact_association":case "listaccount_association":$v_0=false;break;default:break}}return $v_0};Mscrm.QueueItem=function(){};Mscrm.QueueItem.queueManipulation=function(gridControl,records,entityTypeCode,queueAction){for(var $v_0=gridControl,$v_1=$v_0.GetRecordsFromInnerGrid(true),$v_3=0;$v_3<records.length;$v_3++){var $v_4=$v_1[$v_3],$v_5=$v_4[3],$v_6=$v_5.getAttribute("queueitemid");records[$v_3].Id=$v_6;records[$v_3].TypeCode=Mscrm.EntityTypeCode.QueueItem}var $v_2=Mscrm.GridRibbonActions.$0(queueAction,entityTypeCode,records.length);if(queueAction==="queueitemroute"||queueAction==="queueitemworkon")Mscrm.GridRibbonActions.$1($v_2,gridControl,records,480,320);else Mscrm.GridRibbonActions.$1($v_2,gridControl,records,400,250)};Mscrm.QueueItem.queueItemDetail=function(gridControl,records,entityTypeCode,queueAction){if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(records.length!==1){alert(window.LOCID_CUSTMSG_TOOMANY_REC);return}var $v_0=gridControl,$v_1=$v_0.GetRecordsFromInnerGrid(true),$v_2=$v_1[0],$v_3=$v_2[3],$v_4=$v_3.getAttribute("queueitemid");openItem(entityTypeCode,$v_4.toString(),0,null)};Mscrm.QueueItem.hasQueueIdChanged=function(){var $v_0=$get("crmQueueSelector");if(!IsNull($v_0)){var $v_1=$v_0.options[$v_0.selectedIndex],$v_2=$v_1.getAttribute("isdefault");if(!isNullOrEmptyString($v_2)&&Boolean.parse($v_2))return false;else return true}return false};Mscrm.QueueItem.entityQueueItemDetail=function(objectId){var $v_0=new RemoteCommand("QueueItem","GetQueueItemId",null);$v_0.SetParameter("objectId",objectId);var $v_1=$v_0.Execute();if($v_1.Success){var $v_2=$v_1.ReturnValue.toString(),$v_3=XUI.Xml.LoadXml($v_2),$v_4=XUI.Xml.SelectNodes($v_3,"/queueitems/queueitem",null);if($v_4.length===1)openItem(Mscrm.EntityTypeCode.QueueItem,XUI.Xml.GetText($v_4[0]),0,null);else if($v_4.length>1)alert(window.RECORD_ADDED_TO_MULTIPLE_QUEUES);else alert(window.RECORD_ADDED_TO_NO_QUEUE)}};Mscrm.QuickCampaign=function(){};Mscrm.QuickCampaign.quickCampaignSelectedItems=function(gridControl,records,entityTypeCode,totalRecordCount){if(!totalRecordCount)totalRecordCount=gridControl.get_totalRecordCount();if(entityTypeCode===Mscrm.EntityTypeCode.List)if(records.length>1)alert(window.LOCID_MINICAMP_TOOMANY_RECORDS);else{var $v_0=new Array(2);$v_0[0]="statecode";$v_0[1]="membertype";$v_0.type="string";var $v_1=new RemoteCommand("MarketingAutomation","RetrieveList",null);$v_1.SetParameter("id",records[0]);$v_1.SetParameter("columns",$v_0);var $v_2=$v_1.Execute();if($v_2.Success){var $v_3=$v_2.ReturnValue,$v_4=XUI.Xml.LoadXml($v_3),$v_5=XUI.Xml.GetText(XUI.Xml.SelectSingleNode($v_4,"/list/statecode",null));if($v_5==="Inactive")alert(window.LOCID_MC_CANNOT_RUN_INACTLST);else{var $v_6=parseInt(XUI.Xml.GetText(XUI.Xml.SelectSingleNode($v_4,"/list/membertype",null)));Mscrm.QuickCampaign.runMiniCampaign(gridControl,records,entityTypeCode,totalRecordCount,1,$v_6)}}}else Mscrm.QuickCampaign.runMiniCampaign(gridControl,records,entityTypeCode,totalRecordCount,1,entityTypeCode)};Mscrm.QuickCampaign.quickCampaignCurrentPage=function(gridControl,selectedRecordIds,entityTypeCode){if(!gridControl.get_totalRecordCount())alert(window.LOCID_MINICAMP_NORECORDS_MSG);else Mscrm.QuickCampaign.runMiniCampaign(gridControl,selectedRecordIds,entityTypeCode,gridControl.get_pageRecordCount(),2,entityTypeCode)};Mscrm.QuickCampaign.quickCampaignAllPages=function(gridControl,selectedRecordIds,entityTypeCode){if(!IsNull(gridControl.GetParameter("queryapi"))){alert(window.LOCID_QC_CANNOT_RUN_ASSO);return}if(Mscrm.GridRibbonActions.$P(gridControl.GetParameter("viewid"))){alert(window.LOCID_MINICAMP_CANNOT_RUN);return}if(!gridControl.get_totalRecordCount())alert(window.LOCID_MINICAMP_NORECORDS_MSG);else Mscrm.QuickCampaign.runMiniCampaign(gridControl,selectedRecordIds,entityTypeCode,gridControl.get_totalRecordCount(),3,entityTypeCode)};Mscrm.QuickCampaign.runMiniCampaign=function(gridControl,selectedRecords,entityTypeCode,totalRecordCount,mcOption,createdFromOtc){var $v_0={};$v_0["TotalRecords"]=totalRecordCount;$v_0["SelectedRecords"]=selectedRecords.length;$v_0["ObjectTypeCode"]=entityTypeCode;$v_0["MCOption"]=mcOption;$v_0["CreatedFromOtc"]=createdFromOtc;switch(mcOption){case 1:$v_0["MCOptionTitle"]=window.LOCID_MC_SELECTION_SELECTED;$v_0["Ids"]=selectedRecords;$v_0["GridXml"]="";break;case 2:$v_0["MCOptionTitle"]=window.LOCID_MC_SELECTION_ALLONPAGE;$v_0["Ids"]=selectedRecords;$v_0["GridXml"]="";break;case 3:$v_0["MCOptionTitle"]=window.LOCID_MC_SELECTION_ALL;$v_0["Ids"]="";$v_0["GridXml"]=gridControl.get_gridXml();break;default:catchError("Invalid option value passed to RunMiniCampaign().",window.location.href,0,true);break}var $v_1=Mscrm.CrmUri.create("/MA/MiniCampaign/MiniCampaign.aspx");openStdDlg($v_1,$v_0,parseInt(window.LOCID_MC_WINDOW_WIDTH,10),parseInt(window.LOCID_MC_WINDOW_HEIGHT,10))};Mscrm.ReportActions=function(){};Mscrm.ReportActions.viewReport=function(gridControl,records){if(records.length===1){var $v_0=records[0],$v_1=Mscrm.ReportActions.$C(gridControl,$v_0.Id),$v_2=gridControl.getCellValue("filename",$v_0.Id);Mscrm.ReportUtil.viewReport($v_1,$v_0.Id,$v_2,"run",null)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.editReportFilter=function(gridControl,records){if(records.length===1){var $v_0=records[0],$v_1=Mscrm.ReportActions.$C(gridControl,$v_0.Id),$v_2=gridControl.getCellValue("filename",$v_0.Id);Mscrm.ReportUtil.viewReport($v_1,$v_0.Id,$v_2,"editfilter",null)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.editReport=function(records){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(records.length===1){var $v_0=records[0],$v_1=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.ReportPropertyDialog),$v_2=Mscrm.CrmUri.create("/CRMReports/reportproperty.aspx");$v_2.get_query()["id"]=$v_0.Id;openStdWin($v_2,buildWinName($v_0.Id),$v_1.Width,$v_1.Height,null)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.reportScheduleWizard=function(gridControl,records,entityTypeCode){if(records.length===1){var $v_0=records[0],$v_1=Mscrm.ReportActions.$C(gridControl,$v_0.Id);if($v_1===Mscrm.ReportViewType.viewInSrs){var $v_2=700,$v_3=550,$v_4=Mscrm.CrmUri.create("/CRMReports/ReportSchedule/ScheduleWizard.aspx");$v_4.get_query()["id"]=$v_0.Id;!IsNull(openStdDlg($v_4,null,$v_2,$v_3,false,false,null))&&Mscrm.Grid.auto(entityTypeCode,null)}else alert(window.LOCID_NON_SRS_FILTERSCHEDULE)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.$C=function($p0,$p1){return parseInt($p0.getCellValue("reporttypecode",$p1),10)};Mscrm.Goal=function(){};Mscrm.Goal.recalculateGoalAndRefreshGrid=function(gridControl,records){if(confirm(window.LOCID_GOALRECALCULATE_WARNING)){!Mscrm.PageManager.isOutlookProxyPage()&&gridControl.ShowLoadingMessage();Mscrm.Goal.recalculateGoal(records[0].Id,gridControl)}};Mscrm.Goal.recalculateGoalAndRefreshForm=function(recordId){if(confirm(window.LOCID_GOALRECALCULATE_WARNING)){var $v_0=$find("crmForm");$v_0.SubmitCrmForm(66,false,true,false,false)}};Mscrm.Goal.recalculateGoal=function(recordId,gridControl){var $v_0=new RemoteCommand("GoalManagement","RecalculateGoal",null);$v_0.SetParameter("goalId",recordId);if(gridControl)var $v_1=$v_0.Execute(function($p1_0,$p1_1){$p1_0.Success&&gridControl.refresh()});else var $v_2=$v_0.Execute()};Mscrm.Goal.hasFiscalSettingsChanged=function(){if(window.HAS_FISCALSTARTDATE_CHANGED)return true;else return false};Mscrm.Goal.realignFiscalDatesForm=function(recordId){var $v_0=67,$v_1=$find("crmForm");if($v_1.get_isDirty()){alert(window.LOCID_FORM_DIRTY);return}else{var $v_2=Mscrm.CrmUri.create("/SFA/goal/dlg_confirmRealign.aspx"),$v_3=[$v_1,$v_0],$v_4=Mscrm.Utilities.createCallbackFunctionObject("performActionAfterRealignGoal",Mscrm.Goal,$v_3),$v_5=openStdDlgWithCallback($v_2,null,450,200,$v_4,true,false,null);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.Goal.performActionAfterRealignGoal($v_5,$v_1,$v_0)}};Mscrm.Goal.performActionAfterRealignGoal=function(resultValue,crmForm,realignFiscalDates){if(resultValue){var $v_0=Mscrm.FormControlInputBehavior.GetBehavior("fiscalyear"),$v_1=Mscrm.FormControlInputBehavior.GetBehavior("fiscalperiod");Mscrm.PostBackUtil.createHiddenInput("fiscalyear",$v_0.get_dataValue());Mscrm.PostBackUtil.createHiddenInput("fiscalperiod",$v_1.get_dataValue());crmForm.SubmitCrmForm(realignFiscalDates,false,true,false,false)}};Mscrm.Goal.isFiscalPeriodGoal=function(){if(window.IS_FISCALPERIOD_GOAL)return true;else return false};Mscrm.Goal.isRootGoal=function(){if(window.IS_ROOT_GOAL)return true;else return false};Mscrm.Goal.fiscalSettingsAreSame=function(gridControl){var $v_0=true;if(gridControl){var $v_1=gridControl.GetParameter("relName");if($v_1==="goal_parent_goal"&&window.HAS_FISCALSETTING_CHANGED)$v_0=false}return $v_0};Mscrm.Goal.isFormStateNotDisabled=function(){if(window.VAR_IS_FORM_DISABLED==="1")return false;else return true};Mscrm.LeadActions=function(){};Mscrm.LeadActions.convert=function(transactionCurrencyId,entityId,qualifyCallback,unqualifyCallback){var $v_0=Mscrm.CrmUri.create("/SFA/Leads/Dialogs/conv_lead.aspx");if(!isNullOrEmptyString(transactionCurrencyId))$v_0.get_query()["transactioncurrencyid"]=transactionCurrencyId;var $v_1=[entityId,qualifyCallback,unqualifyCallback],$v_2=Mscrm.Utilities.createCallbackFunctionObject("performActionAfterConvertLead",Mscrm.LeadActions,$v_1),$v_3=openStdDlgWithCallback($v_0,null,430,430,$v_2);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.LeadActions.performActionAfterConvertLead($v_3,entityId,qualifyCallback,unqualifyCallback)};Mscrm.LeadActions.performActionAfterConvertLead=function(returnValue,entityId,qualifyCallback,unQCallback){if(returnValue)if(returnValue.qualify)if(returnValue.parentAccount)qualifyCallback(returnValue.showNew,returnValue.account,returnValue.contact,returnValue.opportunity,Mscrm.EntityTypeCode.Account,returnValue.parentAccount,returnValue.OppCurrencyId,returnValue.qualifyStatus,returnValue.suppressDuplicateDetection,entityId);else if(returnValue.parentContact)qualifyCallback(returnValue.showNew,returnValue.account,returnValue.contact,returnValue.opportunity,Mscrm.EntityTypeCode.Contact,returnValue.parentContact,returnValue.OppCurrencyId,returnValue.qualifyStatus,returnValue.suppressDuplicateDetection,entityId);else qualifyCallback(returnValue.showNew,returnValue.account,returnValue.contact,returnValue.opportunity,-1,null,returnValue.OppCurrencyId,returnValue.qualifyStatus,returnValue.suppressDuplicateDetection,entityId);else unQCallback(returnValue.unqualifyStatus,entityId)};Mscrm.LeadActions.getDefaultCurrencyForUser=function(){var $v_0=new RemoteCommand("Currency","GetCurrencyIdForCurrentUser"),$v_1=$v_0.Execute();if($v_1.Success)return $v_1.ReturnValue.toString();return null};Mscrm.LeadActions.getQualifyState=function(){var $v_0=new RemoteCommand("SalesForceAutomation","GetQualifyState"),$v_1=$v_0.Execute();if($v_1.Success)return $v_1.ReturnValue.toString();return null};Mscrm.LeadActions.getDisqualifyState=function(){var $v_0=new RemoteCommand("SalesForceAutomation","GetDisqualifyState"),$v_1=$v_0.Execute();if($v_1.Success)return $v_1.ReturnValue.toString();return null};Mscrm.OpportunityActions=function(){};Mscrm.OpportunityActions.close=function(selectedOpportunities,won,gridControl){var $v_0=selectedOpportunities[0],$v_1=Mscrm.CrmUri.create("/SFA/opps/dlg_closeopp.aspx");$v_1.get_query()["pId"]=$v_0.Id;$v_1.get_query()["pType"]=Mscrm.EntityTypeCode.Opportunity;if(!IsNull(won))$v_1.get_query()["won"]=won;var $v_2=[$v_0,gridControl],$v_3=Mscrm.Utilities.createCallbackFunctionObject("performActionAfterCloseOpportunity",Mscrm.OpportunityActions,$v_2),$v_4=openStdDlgWithCallback($v_1,window.document,450,420,$v_3);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.OpportunityActions.performActionAfterCloseOpportunity($v_4,$v_0,gridControl)};Mscrm.OpportunityActions.performActionAfterCloseOpportunity=function(returnValue,selectedOpportunity,gridControl){if(returnValue){var $v_0=new RemoteCommand("SalesForceAutomation","CloseOpportunity");$v_0.SetParameter("opportunityId",selectedOpportunity.Id);$v_0.SetParameter("opportunityDisplayName",selectedOpportunity.Name);$v_0.SetParameter("activityXml",returnValue.ActivityXml);$v_0.SetParameter("statusCode",returnValue.StatusCode);$v_0.SetParameter("stateCode",returnValue.State);$v_0.Execute();gridControl&&gridControl.refresh()}};Mscrm.RollupField=function(){};Mscrm.RollupField.isTotalLessThanThree=function(gridControl){if(!IsNull(gridControl))if(gridControl.get_totalRecordCount()<3)return true;else return false;return true};Mscrm.SalesLiterature=function(){};Mscrm.SalesLiterature.sendAsEmail=function(id){var $v_0=new RemoteCommand("ActivitiesWebService","CreateEmailFromSalesLiterature",null);$v_0.SetParameter("salesLiteratureId",id);var $v_1=$v_0.Execute(null);if($v_1.Success){var $v_2=$v_1.ReturnValue;if(!IsNull($v_2)&&$v_2.length>0)openObj(Mscrm.EntityTypeCode.Email,$v_2,"");else alert(window.LOCID_SALESLIT_NO_DOCUMENTS)}};Mscrm.SystemUserActions=function(){};Mscrm.SystemUserActions.newMultipleUsers=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=800,$v_1=530,$v_2=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx");$v_2.get_query()["WizardId"]="2631659F-A668-4A48-833B-D20E187B5A89";!IsNull(openStdDlg($v_2,null,$v_0,$v_1,true))&&Mscrm.Grid.auto(Mscrm.EntityTypeCode.SystemUser,null)};Mscrm.SystemUserActions.newUser=function(){locAddRelatedToNonForm(Mscrm.EntityTypeCode.SystemUser,Mscrm.EntityTypeCode.BusinessUnit,_gCurrentBusinessUnitId,"")};Mscrm.SystemUserActions.promoteToAdmin=function(records){if(records.length===1){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_promotetoadmin.aspx");$v_0.get_query()["userid"]=records[0];var $v_1=openStdDlg($v_0,records,300,200);!IsNull($v_1)&&Mscrm.Grid.auto(Mscrm.EntityTypeCode.SystemUser,null)}else alert(LOCID_PROMOTETOADMIN_MULTIPLE)};Mscrm.SystemUserActions.manageRoles=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("role",entityTypeCode,records.length),$v_1=500,$v_2=330;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.SystemUserActions.sendInviteForLive=function(records){var $v_0=450,$v_1=270,$v_2;if(records.length===1){$v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_sendinvite.aspx");$v_2.get_query()["userid"]=records[0].Id;$v_2.get_query()["isform"]=false}else{$v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_sendmultipleinvite.aspx");for(var $v_4=new Sys.StringBuilder,$v_5=0;$v_5<records.length;$v_5++){var $v_6=records[$v_5];!$v_4.isEmpty()&&$v_4.append(",");$v_4.append($v_6.Id)}$v_2.get_query()["sIds"]=$v_4}var $v_3=openStdDlg($v_2,records,$v_0,$v_1);!IsNull($v_3)&&Mscrm.Grid.auto(Mscrm.EntityTypeCode.SystemUser,null)};Mscrm.SystemUserActions.changeBusinessUnit=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("changeorg",entityTypeCode,records.length),$v_1=400,$v_2=325;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.SystemUserActions.isReadFormEnabled=function(){return !IsNull(window.READ_FORM_ENABLED)&&window.READ_FORM_ENABLED};Mscrm.SystemUserActions.setFormReadMode=function(gridControl,records,entityTypeCode,useReadForm){var $v_0=Mscrm.GridRibbonActions.$0("readformmode",entityTypeCode,records.length);$v_0.get_query()["readform"]=useReadForm;var $v_1=400,$v_2=225;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.SystemUserActions.useReadForm=function(gridControl,records,entityTypeCode){Mscrm.SystemUserActions.setFormReadMode(gridControl,records,entityTypeCode,true)};Mscrm.SystemUserActions.useEditForm=function(gridControl,records,entityTypeCode){Mscrm.SystemUserActions.setFormReadMode(gridControl,records,entityTypeCode,false)};Mscrm.SystemUserActions.changeManager=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("changeparent",entityTypeCode,records.length),$v_1=400,$v_2=225;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.SystemUserActions.isCurrentUser=function(userId){if(!IsNull(userId)){userId=userId.toLowerCase();if(userId.charAt(0)==="{")userId=userId.substr(1);if(userId.charAt(userId.length-1)==="}")userId=userId.substr(0,userId.length-1);if(typeof _gCurrentUserId=="undefined")return false;return userId===_gCurrentUserId}return false};Mscrm.SystemUserActions.isInviteUserEnabled=function(){return _bIsInviteUserEnabled};Mscrm.SystemUserActions.isSystemAdministrator=function(){if(typeof _bIsSystemAdministrator=="undefined")return false;return _bIsSystemAdministrator};Mscrm.SystemUserActions.setDevErrorsQuery=function(commandProperties){commandProperties["On"]=_bIsShowDevErrorsEnabled};Mscrm.SystemUserActions.addExistingMemberFromSubGridStandard=function(gridControl){confirm(LOCID_CONFIRM_REMOVAL_FROM_TERR)&&Mscrm.GridRibbonActions.addExistingFromSubGridStandard(Mscrm.EntityTypeCode.SystemUser,gridControl)};Mscrm.SystemUserActions.removeMembers=function(objectId,gridControl,records){var $v_0=Mscrm.GridRibbonActions.$0("removeusers",9003,records.length);$v_0.get_query()["teamid"]=objectId;var $v_1=400,$v_2=200;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.ExportGridToExcel=function(){};Mscrm.ExportGridToExcel.doExportToExcel=function(gridControl,entityTypeCode){var $v_0=Mscrm.ExportGridToExcel.$Y(gridControl,entityTypeCode);(!Mscrm.SessionInfo.isOutlookClient()||Mscrm.SessionInfo.getClientMajorVersion()<5)&&Mscrm.ExportGridToExcel.performExcelExport(gridControl,$v_0,"exportFrame")};Mscrm.ExportGridToExcel.performExcelExport=function(gridControl,dialogResult,target){if(dialogResult){var $v_0=null,$v_1=dialogResult.result;Mscrm.ExportGridToExcel.$e("DownloadOptions");Mscrm.ExportGridToExcel.$V();switch($v_1){case -1:return;case 0:case 1:$v_0=Mscrm.ExportGridToExcel.$W($v_1,gridControl.get_gridXml(),IsNull(gridControl.GetParameter("effectiveFetchXml"))?"":gridControl.GetParameter("effectiveFetchXml"),dialogResult.reimport);$v_0.action=Mscrm.CrmUri.create("/_grid/print/print_data.aspx").toString();$v_0.target=target;break;case 2:$v_0=Mscrm.ExportGridToExcel.$F(gridControl,"list",dialogResult.useSqlQuery,gridControl.get_gridXml(),dialogResult.fetchXml,dialogResult.layoutXml,target);break;case 3:$v_0=Mscrm.ExportGridToExcel.$F(gridControl,"pivot",dialogResult.useSqlQuery,gridControl.get_gridXml(),dialogResult.fetchXml,dialogResult.layoutXml,target);break}$v_0.submit()}};Mscrm.ExportGridToExcel.$Y=function($p0,$p1){var $v_0=$p0.get_pageNumber()>1||$p0.get_hasMorePages();if(isRichClient()&&$p1===Mscrm.EntityTypeCode.ActivityPointer&&Mscrm.SessionInfo.getOutlookMajorVersion()>11)$p1=Number.parseInvariant(getOutlookHostedWindow().getParameter("viewOtc"));var $v_1=Mscrm.CrmUri.create("/_grid/print/export_dlg.aspx");$v_1=Mscrm.CrmUri.updateCrmUriHostAndScheme($v_1);$v_1.get_query()["multipage"]=$v_0?"1":"0";$v_1.get_query()["otc"]=$p1;$v_1.get_query()["TotalRecordCount"]=$p0.get_totalRecordCount().toString();$v_1.get_query()["PageRecordCount"]=$p0.get_pageRecordCount().toString();var $v_2=$p0.GetParameter("effectiveFetchXml"),$v_3=$p0.GetParameter("fetchXml"),$v_4=new Mscrm.ExportDialogArguments;if(!isNullOrEmptyString($v_2))$v_4.effectiveFetchXml=$v_2;if(!isNullOrEmptyString($v_3))$v_4.fetchXml=$v_3;$v_4.layoutXml=Mscrm.ExportGridToExcel.$U($p0.get_gridXml());$v_4.gridControl=$p0;$v_1.get_query()["DuplicateColumnsPresent"]=Mscrm.ExportGridToExcel.$a($p0.get_gridXml())?"1":"0";$v_1.get_query()["viewid"]=$p0.GetParameter("viewid");$v_1.get_query()["viewtype"]=$p0.GetParameter("viewtype");$v_1.get_query()["isFetchFinal"]=Mscrm.GridRibbonActions.$N($p0)?"1":"0";var $v_5=$p0.GetParameter("oId");if(!IsNull($v_5))$v_1.get_query()["oid"]=$v_5;var $v_6=parseInt(window.LOCID_EXPORT_WINDOW_WIDTH,10),$v_7=parseInt(window.LOCID_EXPORT_WINDOW_HEIGHT,10);return openStdDlg($v_1,$v_4,$v_6,$v_7)};Mscrm.ExportGridToExcel.$U=function($p0){var $v_0=new Sys.StringBuilder,$v_1=XUI.Xml.LoadXml($p0),$v_2=false;try{$v_0.append('<grid name="excelGrid" select="0" icon="0" preview="0">');var $v_3=XUI.Xml.SelectSingleNode($v_1,"grid/parameters/layoutXml",null),$v_4=XUI.Xml.LoadXml(XUI.Xml.GetText($v_3)),$v_5=XUI.Xml.SelectSingleNode($v_4,"grid/row",null);$v_0.append(XUI.Xml.XMLSerializer.serializeToString($v_5));$v_0.append("</grid>")}catch($$e_7){$v_2=true;$v_0.clear()}if($v_2){$v_0.append('<grid name="excelGrid" select="0" icon="0" preview="0"><row name="excelRow">');for(var $v_6=XUI.Xml.SelectNodes($v_1,"grid/columns/column",null),$v_7=0;$v_7<$v_6.length;$v_7++){var $v_8=$v_6[$v_7];if(!IsNull($v_8)){var $v_9=$v_8.attributes.getNamedItem("width"),$v_A=$v_8.attributes.getNamedItem("fieldname");if(!IsNull($v_9)&&!isNullOrEmptyString($v_9.nodeValue)&&!IsNull($v_A)&&!isNullOrEmptyString($v_A.nodeValue)){$v_0.append('<cell width="');$v_0.append(CrmEncodeDecode.CrmXmlAttributeEncode($v_9.nodeValue));$v_0.append('" name="');$v_0.append(CrmEncodeDecode.CrmXmlAttributeEncode(XUI.Xml.GetText($v_8)));$v_0.append('" />')}}}$v_0.append("</row></grid>")}return $v_0.toString()};Mscrm.ExportGridToExcel.$a=function($p0){var $v_0=XUI.Xml.LoadXml($p0),$v_1=null,$v_2=XUI.Xml.SelectSingleNode($v_0,"grid/parameters/otn",null);if($v_2)$v_1=XUI.Xml.GetText($v_2);for(var $v_3=XUI.Xml.SelectNodes($v_0,"grid/columns/column",null),$v_4=[],$v_5=0;$v_5<$v_3.length;$v_5++){var $v_6=$v_3[$v_5];if(!IsNull($v_6)){var $v_7=$v_6.attributes.getNamedItem("isHidden");if(!IsNull($v_7)&&!isNullOrEmptyString($v_7.nodeValue))if($v_7.nodeValue==="true")continue;var $v_8=$v_6.attributes.getNamedItem("label");if(!IsNull($v_8)&&!isNullOrEmptyString($v_8.nodeValue)){if(Array.contains($v_4,$v_8.nodeValue))return true;Array.add($v_4,$v_8.nodeValue)}}}return false};Mscrm.ExportGridToExcel.$W=function($p0,$p1,$p2,$p3){var $v_0=document.getElementsByName("gridExportStatic")[0];if(!IsNull($v_0))Mscrm.GridRibbonActions.$8($v_0);else{$v_0=document.createElement("form");$v_0.name="gridExportStatic";$v_0.method="post";$v_0.style.display="none";document.body.appendChild($v_0)}Mscrm.GridRibbonActions.$2($v_0,"gridXml",$p1);Mscrm.GridRibbonActions.$2($v_0,"fetchXml",$p2);Mscrm.GridRibbonActions.$2($v_0,"printAllPages",$p0.toString());Mscrm.GridRibbonActions.$2($v_0,"reimport",$p3?"1":"0");return $v_0};Mscrm.ExportGridToExcel.$V=function(){var $v_0=$get("exportFrame");if(!IsNull($v_0))return;$v_0=document.createElement("iframe");$v_0.id="exportFrame";$v_0.setAttribute("name","exportFrame");$v_0.setAttribute("style","display: none");document.body.appendChild($v_0);$v_0.contentWindow.name="exportFrame"};Mscrm.ExportGridToExcel.$F=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $v_0=document.getElementsByName("gridExportLive")[0];if(!IsNull($v_0))Mscrm.GridRibbonActions.$8($v_0);else{$v_0=document.createElement("form");$v_0.setAttribute("name","gridExportLive");$v_0.setAttribute("method","post");$v_0.setAttribute("target",$p6);$v_0.setAttribute("action",Mscrm.CrmUri.create("/_grid/print/export_live.aspx").toString());document.body.appendChild($v_0)}var $v_1=document.createElement("div");$v_1.style.height="72pt";$v_1.style.width="72pt";$v_1.style.visibility="hidden";document.body.appendChild($v_1);var $v_2=$v_1.offsetWidth;$v_1.parentNode.removeChild($v_1);Mscrm.GridRibbonActions.$2($v_0,"gridXml",$p3);Mscrm.GridRibbonActions.$2($v_0,"xdpi",$v_2.toString());Mscrm.GridRibbonActions.$2($v_0,"exportType",$p1);Mscrm.GridRibbonActions.$2($v_0,"useSqlQuery",$p2?"1":"0");Mscrm.GridRibbonActions.$2($v_0,"fetchXml",isNullOrEmptyString($p4)?"":$p4);Mscrm.GridRibbonActions.$2($v_0,"layoutXml",isNullOrEmptyString($p5)?"":$p5);Mscrm.GridRibbonActions.$2($v_0,"viewid",$p0.GetParameter("viewid"));Mscrm.GridRibbonActions.$2($v_0,"viewtype",$p0.GetParameter("viewtype"));return $v_0};Mscrm.ExportGridToExcel.$e=function($p0){var $v_0=window.top.document.getElementsByTagName("Head");if(!IsNull($v_0)&&$v_0.length){var $v_1=window.top.document.getElementsByTagName("Head")[0];if(!IsNull($v_1)){var $v_2=$v_1.getElementsByTagName("meta");if(!IsNull($v_2)&&$v_2.length)for(var $v_3=0;$v_3<$v_2.length;$v_3++){var $v_4=$v_2[$v_3].getAttribute("name");!IsNull($v_4)&&$v_4===$p0&&$v_1.removeChild($v_2[$v_3])}}}};Mscrm.DashboardRibbonActions=function(){};Mscrm.DashboardRibbonActions.$3=function(){if(!IsNull(Mscrm.DashboardRibbonActions.$5))return Mscrm.DashboardRibbonActions.$5;Mscrm.DashboardRibbonActions.$5=$find("dashboardSelector");if(IsNull(Mscrm.DashboardRibbonActions.$5))Mscrm.DashboardRibbonActions.$5=window.parent.Sys.Application.findComponent("dashboardSelector");return Mscrm.DashboardRibbonActions.$5};Mscrm.DashboardRibbonActions.$4=function($p0){if(!IsNull($p0)){if(!$p0.get_dashboardItems().length)return false;return true}return false};Mscrm.DashboardRibbonActions.isAnyDashboardSelected=function(){return Mscrm.DashboardRibbonActions.$4(Mscrm.DashboardRibbonActions.$3())};Mscrm.DashboardRibbonActions.isUserFormSelected=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$4($v_0)){var $v_1=$v_0.get_selector().attributes.getNamedItem("CurrentItemType");if(!IsNull($v_1)&&parseInt($v_1.value,10)===Mscrm.EntityTypeCode.UserForm)return true}return false};Mscrm.DashboardRibbonActions.isUserDefaultDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$4($v_0)){var $v_1=$v_0.get_selector().attributes.getNamedItem("CurrentItem").value,$v_2=$v_0.get_selector().attributes.getNamedItem("userDefaultItem");if(!IsNull($v_2))if($v_2.value.toLowerCase()===$v_1)return true}return false};Mscrm.DashboardRibbonActions.deleteDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$4($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=$v_0.get_currentType(),$v_3=Mscrm.CrmUri.create("/_grid/cmds/dlg_delete.aspx");$v_3.get_query()["iObjType"]=$v_2.toString();$v_3.get_query()["iTotal"]="1";$v_3.get_query()["sIds"]=$v_1;var $v_4=Mscrm.Utilities.createCallbackFunctionObject("refreshDashboardCallback",Mscrm.DashboardRibbonActions),$v_5=openStdDlgWithCallback($v_3,[$v_1],405,205,$v_4);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.DashboardRibbonActions.refreshDashboardCallback($v_5)}};Mscrm.DashboardRibbonActions.refreshDashboardCallback=function(returnInfo){!IsNull(returnInfo)&&returnInfo&&Mscrm.DashboardRibbonActions.refreshDashboardSelector(null,true)};Mscrm.DashboardRibbonActions.assignDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$4($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=new Mscrm.EntityReference;$v_2.TypeCode=$v_0.get_currentType();$v_2.Id=$v_1;var $v_3=[$v_2],$v_4=Mscrm.GridRibbonActions.$0("assign",$v_2.TypeCode,1),$v_5=Mscrm.Utilities.createCallbackFunctionObject("refreshDashboardCallback",Mscrm.DashboardRibbonActions),$v_6=Mscrm.GridRibbonActions.$I($v_4,$v_3,456,310,null,$v_5);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.DashboardRibbonActions.refreshDashboardCallback($v_6)}};Mscrm.DashboardRibbonActions.shareDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$4($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=$v_0.get_currentType(),$v_3=new Mscrm.EntityReference;$v_3.TypeCode=$v_2;$v_3.Id=$v_1;var $v_4=[$v_3],$v_5=Mscrm.GridRibbonActions.$0("share",$v_3.TypeCode,1),$v_6=Mscrm.GridRibbonActions.$I($v_5,$v_4,800,480,null)}};Mscrm.DashboardRibbonActions.saveDashboardAs=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$4($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=$v_0.get_currentType(),$v_3=$v_0.getDashboardNode($v_1),$v_4="";if(!IsNull($v_3.attributes.getNamedItem("desc")))$v_4=XUI.Xml.GetText($v_3.attributes.getNamedItem("desc"));var $v_5="";if(!IsNull($v_3.attributes.getNamedItem("display")))$v_5=XUI.Xml.GetText($v_3.attributes.getNamedItem("display"));var $v_6={};$v_6.sName=$v_5;$v_6.sDescription=$v_4;var $v_7=[$v_1,$v_2],$v_8=Mscrm.Utilities.createCallbackFunctionObject("saveAsDashboardCallback",Mscrm.DashboardRibbonActions,$v_7),$v_9=openStdDlgWithCallback(Mscrm.CrmUri.create("/AdvancedFind/QueryProperties.aspx?feature=dashboard"),$v_6,500,310,$v_8,false,false,null);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.DashboardRibbonActions.saveAsDashboardCallback($v_9,$v_1,$v_2)}};Mscrm.DashboardRibbonActions.saveAsDashboardCallback=function(dashboardInfo,dashboardId,dashboardTypeCode){if(!IsNull(dashboardInfo)){var $v_0=new RemoteCommand("DashboardWebService","SaveCopyOfDashboard",null);$v_0.SetParameter("sourceDashboardId",dashboardId);$v_0.SetParameter("sourceDashboardObjectTypeCode",dashboardTypeCode);$v_0.SetParameter("name",dashboardInfo.sName);$v_0.SetParameter("description",dashboardInfo.sDescription);var $v_1=$v_0.Execute();if($v_1.Success){var $v_2=$v_1.ReturnValue;Mscrm.DashboardRibbonActions.refreshDashboardSelector($v_2,true);var $v_3=Mscrm.DashboardRibbonActions.$3();$v_3.get_selector().setAttribute("defaultItem",dashboardId);refreshRibbon();$v_3.updateStickyDashboardUrl($v_2)}}};Mscrm.DashboardRibbonActions.refreshDashboardPage=function(){var $v_0=$find("crmPageManager");!IsNull($v_0)&&$v_0.raiseEvent(Mscrm.ScriptEvents.OnDashboardRefresh,null)};Mscrm.DashboardRibbonActions.setUserDefaultDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$4($v_0)&&!IsNull($v_0.get_selector().attributes.getNamedItem("CurrentItem"))){var $v_1=$v_0.get_selector().attributes.getNamedItem("CurrentItem").value,$v_2=new Sys.StringBuilder;$v_2.append("<usersettings>");$v_2.append("<defaultdashboardid>");$v_2.append($v_1);$v_2.append("</defaultdashboardid>");$v_2.append("</usersettings>");var $v_3=new XMLHttpRequest,$v_4=Mscrm.CrmUri.create("/Tools/PersonalSettings/cmds/cmd_update.aspx");$v_3.open("POST",$v_4.toString(),false);Mscrm.Utilities.setResponseTypeToMSXml($v_3);Mscrm.WrpcTokenFuncs.setTokenInHeader($v_3,$v_4);$v_3.send($v_2.toString());var $v_5=$v_3.responseXML,$v_6=XUI.Xml.SelectSingleNode($v_5,"/error",null);if(IsNull($v_6)){$v_0.get_selector().setAttribute("userDefaultItem",$v_1);refreshRibbon()}Mscrm.XmlUtil.handleXMLErr($v_5,true)}};Mscrm.DashboardRibbonActions.editDashboard=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=Mscrm.CrmUri.create(Mscrm.DashboardRibbonActions.$9),$v_1=Mscrm.DashboardRibbonActions.$3(),$v_2=$v_1.get_selector().attributes.getNamedItem("CurrentItem").value,$v_3=$v_1.get_selector().attributes.getNamedItem("CurrentItemType").value,$v_4="&formId="+$v_2+"&dashboardType="+$v_3;$v_0.get_query()["extraqs"]=$v_4;openStdWin($v_0,buildWinName(null),Mscrm.DashboardRibbonActions.$B,Mscrm.DashboardRibbonActions.$A,null)};Mscrm.DashboardRibbonActions.createNewDashboard=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=openStdDlg(Mscrm.CrmUri.create("/tools/dashboardeditor/dialogs/dashboardlayoutdialog.aspx"),null,720,450,false,false,null);if(!IsNull($v_0)){var $v_1=Mscrm.CrmUri.create(Mscrm.DashboardRibbonActions.$9),$v_2="&layoutId="+$v_0+"&dashboardType="+Mscrm.EntityTypeCode.UserForm;$v_1.get_query()["extraqs"]=$v_2;openStdWin($v_1,buildWinName(null),Mscrm.DashboardRibbonActions.$B,Mscrm.DashboardRibbonActions.$A,null)}};Mscrm.DashboardRibbonActions.refreshDashboardSelector=function(dashboardId,refreshDashboard){var $v_0=Mscrm.DashboardRibbonActions.$3();if(!IsNull($v_0)){dashboardId=Mscrm.DashboardRibbonActions.$f(dashboardId);$v_0.hide();var $v_1=new RemoteCommand("DashboardWebService","DashboardSelectorContent",null);$v_1.SetParameter("showNewDashboard",true);var $v_2=$v_1.Execute();$v_2.Success&&$v_0.loadList($v_2.ReturnValue,dashboardId,refreshDashboard)}};Mscrm.DashboardRibbonActions.$f=function($p0){if(isNullOrEmptyString($p0))return $p0;if(!$p0.startsWith("{"))$p0="{"+$p0;if(!$p0.endsWith("}"))$p0=$p0+"}";return $p0};Mscrm.DashboardEditorRibbonActions=function(){};Mscrm.DashboardEditorRibbonActions.showPropertiesDialog=function(){var $v_0=$get("dashboardNameInput"),$v_1=$get("dashboardDescriptionInput"),$v_2="",$v_3="";if(!IsNull($v_0)&&!IsNull($v_1)){$v_2=$v_0.value;$v_3=$v_1.value}var $v_4={};$v_4.sName=$v_2;$v_4.sDesc=$v_3;var $v_5=openStdDlg(Mscrm.CrmUri.create("/Tools/DashboardEditor/Dialogs/DashboardProperties.aspx"),$v_4,500,310,false,false,null);if(!IsNull($v_5)&&!IsNull($v_0)&&!IsNull($v_1)){$v_0.value=$v_5.sName;$v_1.value=$v_5.sDesc}};Mscrm.GridRibbonActions=function(){};Mscrm.GridRibbonActions.addActivityFromGrid=function(activityType,contentId,entityReference){Mscrm.AddActivity.addActivityToSelectedObject(activityType,contentId,entityReference[0])};Mscrm.GridRibbonActions.assignSelectedRecords=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("assign",entityTypeCode,selectedRecords.length),$v_1=false,$v_2=false,$v_3=false,$v_4=456,$v_5=310;if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode)&&Mscrm.EtcUtil.isUserDefinedEntityObjectTypeCode(entityTypeCode))$v_1=true;switch(entityTypeCode){case Mscrm.EntityTypeCode.QueueItem:$v_3=true;$v_2=true;$v_1=true;break;case Mscrm.EntityTypeCode.ActivityPointer:case Mscrm.EntityTypeCode.Email:case Mscrm.EntityTypeCode.Fax:case Mscrm.EntityTypeCode.PhoneCall:case Mscrm.EntityTypeCode.Letter:case Mscrm.EntityTypeCode.Appointment:case Mscrm.EntityTypeCode.ServiceAppointment:$v_2=true;$v_1=true;break;case Mscrm.EntityTypeCode.Incident:case Mscrm.EntityTypeCode.CampaignResponse:case Mscrm.EntityTypeCode.CampaignActivity:case Mscrm.EntityTypeCode.Task:$v_1=true;break}if($v_1&&!IsNull(selectedRecords)){$v_0=Mscrm.GridRibbonActions.$0("assignqueue",entityTypeCode,selectedRecords.length);$v_0.get_query()["sQType"]=1;$v_4=500;$v_5=310;if($v_2){for(var $v_6=new Sys.StringBuilder,$v_7=0;$v_7<selectedRecords.length;$v_7++){$v_7>0&&$v_6.append(",");$v_6.append(selectedRecords[$v_7].TypeCode.toString())}$v_0.get_query()["sSubTypes"]=$v_6.toString()}if($v_3){var $v_8=crmQList;if(!IsNull($v_8))$v_0.get_query()["sSrcId"]=$v_8.firstChild.get_selectedId()}if(selectedRecords.length>0)$v_0.get_query()["uid"]=selectedRecords[0].Id}Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,$v_4,$v_5)};Mscrm.GridRibbonActions.shareSelectedRecords=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("share",entityTypeCode,selectedRecords.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,800,480)};Mscrm.GridRibbonActions.openInstallSPGridLink=function(){var $v_0="http://go.microsoft.com/fwlink/?LinkId=196925";safeWindowOpen(Mscrm.CrmUri.create($v_0),"SPInstallGrid","location=1, width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1",true)};Mscrm.GridRibbonActions.validateSharePointSites=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_sharepoint_validate.aspx");if(!Mscrm.Utilities.isModalDialogSupported()||Sys.Browser.agent===Sys.Browser.Firefox){for(var $v_1=new Array(0),$v_4=0;$v_4<selectedRecords.length;$v_4++)$v_1[$v_4]=selectedRecords[$v_4].Id;var $v_2=[gridControl],$v_3=Mscrm.Utilities.createCallbackFunctionObject("validateSharePointSitesCallback",Mscrm.GridRibbonActions,$v_2,false);openStdDlgWithCallback($v_0,$v_1,800,580,$v_3);return}Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,800,580,null,true)};Mscrm.GridRibbonActions.validateSharePointSitesCallback=function(result,gridControl){!IsNull(gridControl)&&gridControl.refresh()};Mscrm.GridRibbonActions.bulkEdit=function(gridControl,records,entityTypeCode){if(records.length===1){var $v_0=getParentEntityIdParams();if(IsNull($v_0)||!$v_0.length)$v_0="rof=false";else $v_0+="&rof=false";if(!IsNull(gridControl)){var $v_2=gridControl;if(!IsNull($v_2))try{$v_2.get_innerGrid().openSelectedRecord($v_0);return}catch($$e_5){}}var $v_1=records[0];openObj($v_1.TypeCode,$v_1.Id,$v_0)}else{var $v_3;if(entityTypeCode===Mscrm.EntityTypeCode.ActivityPointer){for(var $v_4=records[0],$v_5=1;$v_5<records.length;$v_5++)if(records[$v_5].TypeCode!==$v_4.TypeCode){alert(window.LOCID_HETROGENEOUS_ACTIVITY);return}$v_3=Mscrm.GridRibbonActions.$0("bulkedit",$v_4.TypeCode,records.length)}else $v_3=Mscrm.GridRibbonActions.$0("bulkedit",entityTypeCode,records.length);Mscrm.GridRibbonActions.$1($v_3,gridControl,records,700,540)}};Mscrm.GridRibbonActions.activate=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("activate",entityTypeCode,records.length);if(entityTypeCode===Mscrm.EntityTypeCode.Workflow&&records.length>0)$v_0.get_query()["iObjSubtype"]=gridControl.getCellValue("type",records[0].Id);else if(entityTypeCode===Mscrm.EntityTypeCode.CampaignResponse&&records.length>0)$v_0.get_query()["bulkChangeStateMode"]="1";Mscrm.GridRibbonActions.$1($v_0,gridControl,records,500)};Mscrm.GridRibbonActions.addNotes=function(gridControl,records,entityTypeCode){var $v_0=500,$v_1=270,$v_2=Mscrm.GridRibbonActions.$0("addnotes",entityTypeCode,records.length);$v_2.get_query()["sSubTypes"]=Mscrm.GridRibbonActions.$L(records);Mscrm.GridRibbonActions.$1($v_2,gridControl,records,$v_0,$v_1)};Mscrm.GridRibbonActions.cancelContractDetail=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("cancel",entityTypeCode,records.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,records)};Mscrm.GridRibbonActions.setRegarding=function(gridControl,records,entityTypeCode){var $v_0=500,$v_1=200,$v_2=Mscrm.GridRibbonActions.$0("setregarding",entityTypeCode,records.length);$v_2.get_query()["sSubTypes"]=Mscrm.GridRibbonActions.$L(records);Mscrm.GridRibbonActions.$1($v_2,gridControl,records,$v_0,$v_1)};Mscrm.GridRibbonActions.isBulkSetRegardingValid=function(entityTypeCode,records){if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode)){if(isRichClient()&&entityTypeCode===Mscrm.EntityTypeCode.ActivityPointer)entityTypeCode=Number.parseInvariant(getOutlookHostedWindow().getParameter("viewOtc"));switch(entityTypeCode){case Mscrm.EntityTypeCode.ActivityPointer:for(var $v_0=0;$v_0<records.length;$v_0++)if(records[$v_0].TypeCode===Mscrm.EntityTypeCode.CampaignActivity)return false;return true;case Mscrm.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.EntityTypeCode.CampaignActivity:return false;default:return true}}else return false};Mscrm.GridRibbonActions.isBulkSaveAsCompletedValid=function(entityTypeCode){if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode)){if(isRichClient()&&entityTypeCode===Mscrm.EntityTypeCode.ActivityPointer)entityTypeCode=Number.parseInvariant(getOutlookHostedWindow().getParameter("viewOtc"));switch(entityTypeCode){case Mscrm.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.EntityTypeCode.CampaignActivity:case Mscrm.EntityTypeCode.CampaignResponse:case Mscrm.EntityTypeCode.Email:return false;default:return true}}else return false};Mscrm.GridRibbonActions.isBulkAddNotesValid=function(entityTypeCode){if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode))switch(entityTypeCode){case Mscrm.EntityTypeCode.Email:return false;default:return true}else return false};Mscrm.GridRibbonActions.isBulkSaveAsCancelledValid=function(entityTypeCode){if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode)){if(isRichClient()&&entityTypeCode===Mscrm.EntityTypeCode.ActivityPointer)entityTypeCode=Number.parseInvariant(getOutlookHostedWindow().getParameter("viewOtc"));switch(entityTypeCode){case Mscrm.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.EntityTypeCode.Email:return false;default:return true}}else return false};Mscrm.GridRibbonActions.isBulkEditValid=function(entityTypeCode){if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode)){if(isRichClient()&&entityTypeCode===Mscrm.EntityTypeCode.ActivityPointer)entityTypeCode=Number.parseInvariant(getOutlookHostedWindow().getParameter("viewOtc"));switch(entityTypeCode){case Mscrm.EntityTypeCode.RecurringAppointmentMaster:return false;default:return true}}else return false};Mscrm.GridRibbonActions.isValidForExportDataTemplate=function(entityTypeCode){return Mscrm.EntityPropUtil.isImportableTypeCode(entityTypeCode)};Mscrm.GridRibbonActions.deactivate=function(gridControl,records,entityTypeCode,defaultCloseState){var $v_0=500,$v_1=200,$v_2=Mscrm.GridRibbonActions.$0("deactivate",entityTypeCode,records.length),$v_3="";switch(entityTypeCode){case Mscrm.EntityTypeCode.BusinessUnit:$v_0=650;$v_1=280;for(var $v_5=0;$v_5<records.length;$v_5++)$v_3+=records[$v_5].Id;break;case Mscrm.EntityTypeCode.DiscountType:case Mscrm.EntityTypeCode.Account:case Mscrm.EntityTypeCode.Contact:$v_1=280;break;case Mscrm.EntityTypeCode.Workflow:if(records.length>0)$v_2.get_query()["iObjSubtype"]=gridControl.getCellValue("type",records[0].Id);break;case Mscrm.EntityTypeCode.CampaignActivity:case Mscrm.EntityTypeCode.CampaignResponse:$v_1=250;$v_0=400;break;case Mscrm.EntityTypeCode.ActivityPointer:for(var $v_4=records[0],$v_6=1;$v_6<records.length;$v_6++)if(records[$v_6].TypeCode!==$v_4.TypeCode){alert(window.LOCID_HETROGENEOUS_ACTIVITY);return}switch($v_4.TypeCode){case Mscrm.EntityTypeCode.Email:alert(window.LOCID_INCOM_TYPE_EMAIL);return;case Mscrm.EntityTypeCode.CampaignResponse:case Mscrm.EntityTypeCode.CampaignActivity:if(defaultCloseState===1){alert(window.LOCID_INCOM_TYPE_CAMP);return}break}$v_2=Mscrm.GridRibbonActions.$0("deactivate",$v_4.TypeCode,records.length);break}$v_2.get_query()["sIds"]=$v_3;$v_2.get_query()["bulkChangeStateMode"]="1";if(!IsNull(defaultCloseState))$v_2.get_query()["iStateCode"]=defaultCloseState;Mscrm.GridRibbonActions.$1($v_2,gridControl,records,$v_0,$v_1)};Mscrm.GridRibbonActions.deleteRecords=function(gridControl,records,entityTypeCode){return Mscrm.Grid.deleteRecords(gridControl,records,entityTypeCode)};Mscrm.GridRibbonActions.mergeRecords=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("merge",entityTypeCode,records.length);if(records.length>2){alert(window.LOCID_MERGE_TOOMANY_RECORDS);return}for(var $v_1=new Sys.StringBuilder,$v_4=0;$v_4<records.length;$v_4++){$v_4>0&&$v_1.append(";");$v_1.append(records[$v_4].Id)}$v_0.get_query()["sIds"]=$v_1.toString();var $v_2=[false,gridControl],$v_3=Mscrm.Utilities.createCallbackFunctionObject("refreshGridAfterMerge",Mscrm.GridRibbonActions,$v_2);Mscrm.GridRibbonActions.$1($v_0,gridControl,records,800,570,$v_3)};Mscrm.GridRibbonActions.refreshGridAfterMerge=function(result,forceRefresh,gridControl){(result||forceRefresh)&&gridControl.refresh()};Mscrm.GridRibbonActions.recalculateFromGrid=function(gridControl,selectedRecords,entityTypeCode){var $v_0=null,$v_1=Mscrm.GridRibbonActions.$0("recalc_opps",entityTypeCode,selectedRecords.length);if(selectedRecords&&selectedRecords.length>=1){for(var $v_2=new Sys.StringBuilder,$v_4=0;$v_4<selectedRecords.length;$v_4++){$v_4>0&&$v_2.append(";");$v_2.append(selectedRecords[$v_4].Id)}var $v_3=[];$v_3[0]=$v_2;$v_0=$v_3}Mscrm.GridRibbonActions.$1($v_1,gridControl,selectedRecords,400,250,null,true,$v_0)};Mscrm.GridRibbonActions.detectDuplicatesAllRecords=function(gridControl,entityTypeCode,totalRecordCount){if(!IsNull(gridControl.GetParameter("queryapi"))){alert(window.LOCID_DEDUPE_CANNOT_RUN_ASSO);return}if(Mscrm.GridRibbonActions.$P(gridControl.GetParameter("viewid"))){alert(window.LOCID_DEDUPE_CANNOT_RUN);return}if(!totalRecordCount){alert(window.LOCID_DEDUPE_NORECORDS_MSG);return}var $v_0=new Mscrm.DetectDuplicateArguments;$v_0.ObjectTypeCode=entityTypeCode;$v_0.iOption=2;$v_0.GridXml=gridControl.get_gridXml();$v_0.Ids="";$v_0.ViewName=gridControl.get_viewTitle();Mscrm.GridRibbonActions.$H($v_0)};Mscrm.GridRibbonActions.detectDuplicatesSelectedRecords=function(entityTypeCode,recordIds){var $v_0=new Mscrm.DetectDuplicateArguments;$v_0.ObjectTypeCode=entityTypeCode;$v_0.iOption=1;$v_0.GridXml="";$v_0.Ids=recordIds;$v_0.ViewName="";Mscrm.GridRibbonActions.$H($v_0)};Mscrm.GridRibbonActions.bulkDelete=function(gridControl){var $v_0=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=A50E9478-8EC9-45ab-B927-FDFFF64A0729");if(!IsNull(gridControl)){var $v_2=gridControl.GetParameter("otc"),$v_3="";if(!isNullOrEmptyString($v_2)){$v_3=$v_2;var $v_4=gridControl.GetParameter("viewid"),$v_5=gridControl.GetParameter("viewtype");if(!isNullOrEmptyString($v_4)&&!isNullOrEmptyString($v_5))$v_3=$v_3+","+$v_5+","+$v_4;$v_0.get_query()["WizardInput"]=$v_3}}var $v_1=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.BulkDeleteWizardDialog);openStdDlg($v_0,null,$v_1.Width,$v_1.Height,true,false,"maximize:yes;minimize:yes")};Mscrm.GridRibbonActions.addToList=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("addtolist",entityTypeCode,records.length),$v_1=Mscrm.CrmUri.create(window.location.search);if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}for(var $v_2=true,$v_5=0;$v_5<records.length&&$v_2;$v_5++)if(records[$v_5].TypeCode!==records[0].TypeCode)$v_2=false;if(!$v_2){alert(window.LOCID_HETEROGENOUS_TYPES);return}var $v_3=$v_1.get_query()["listId"]||"",$v_4="";if($v_1.get_query()["invoker"]!=="listmembers"){var $v_6=[$v_0,gridControl,records],$v_7=Mscrm.Utilities.createCallbackFunctionObject("setPropertiesAndMakeCall",Mscrm.GridRibbonActions,$v_6),$v_8=LookupObjectsWithCallback($v_7,null,"single","4300",0,null,"membertypecode="+CrmEncodeDecode.CrmUrlEncode(records[0].TypeCode.toString())+"&listType="+CrmEncodeDecode.CrmUrlEncode("static"),1,1,false,"","","","577EA96E-B1F6-499b-98A7-ABB5BE8233F9",null,null,null,null,null,null,null,null,null);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.GridRibbonActions.setPropertiesAndMakeCall($v_8,$v_0,gridControl,records);return}Mscrm.GridRibbonActions.$Q($v_3,$v_4,$v_0,gridControl,records)};Mscrm.GridRibbonActions.setPropertiesAndMakeCall=function(lookupItems,actionUri,gridControl,records){var $v_0,$v_1;if(!IsNull(lookupItems)&&lookupItems.items.length>0){$v_0=lookupItems.items[0].id;$v_1=lookupItems.items[0].type;Mscrm.GridRibbonActions.$Q($v_0,$v_1,actionUri,gridControl,records)}};Mscrm.GridRibbonActions.$Q=function($p0,$p1,$p2,$p3,$p4){$p2.get_query()["itemObjectId"]=$p0;$p2.get_query()["itemObjectTypeCode"]=$p1;Mscrm.GridRibbonActions.$1($p2,$p3,$p4)};Mscrm.GridRibbonActions.addToQueue=function(gridControl,records,entityTypeCode){for(var $v_0=Mscrm.GridRibbonActions.$0("addtoqueue",entityTypeCode,records.length),$v_1=false,$v_2=new Sys.StringBuilder,$v_3=0;$v_3<records.length;$v_3++){if(entityTypeCode!==records[$v_3].TypeCode)$v_1=true;$v_3>0&&$v_2.append(",");$v_2.append(records[$v_3].TypeCode.toString())}if($v_1){$v_0.get_query()["iIndex"]=0;$v_0.get_query()["sSubTypes"]=$v_2.toString()}Mscrm.GridRibbonActions.$1($v_0,gridControl,records)};Mscrm.GridRibbonActions.addConnection=function(records,connectToMe){if(records.length!==1){alert(window.LOCID_CUSTMSG_TOOMANY_REC);return}var $v_0=records[0],$v_1="?pId="+CrmEncodeDecode.CrmUrlEncode($v_0.Id)+"&pType="+CrmEncodeDecode.CrmUrlEncode($v_0.TypeCode.toString());if(connectToMe)$v_1=$v_1+"&connectToMe=true";openObj(Mscrm.EntityTypeCode.Connection,"",$v_1)};Mscrm.GridRibbonActions.sendCurrentViewUrl=function(useEmail,gridControl){var $v_0=gridControl.get_viewTitle();if(IsNull($v_0)||$v_0===window.LOCID_SEARCH_RESULTS||gridControl.get_viewIsUserOwned()||Mscrm.GridRibbonActions.$d(gridControl.GetParameter("viewid"))){alert(window.LOCID_ERROR_INVALID_VIEW);return}var $v_1=Mscrm.Shortcuts.getViewUrl();if(isOutlookHostedWindow()){var $v_2=$v_1.get_query()["extraqs"];if($v_2&&$v_2.length>0){for(var $v_3="ver=",$v_4=null,$v_5=($v_2.startsWith("?")?$v_2.substr(1):$v_2).split("&"),$v_6=0;$v_6<$v_5.length;++$v_6)if($v_5[$v_6].startsWith($v_3)){$v_4=$v_5[$v_6];break}if($v_4)if($v_5.length===1)delete $v_1.get_query().extraqs;else $v_1.get_query()["extraqs"]=$v_2.replace($v_4,"")}}Mscrm.GridRibbonActions.$T(gridControl,$v_1);Mscrm.Utilities.sendViewUrl(useEmail,$v_1,$v_0,gridControl.GetParameter("viewid"),gridControl.GetParameter("viewtype"))};Mscrm.GridRibbonActions.$T=function($p0,$p1){var $v_0=$p0.GetParameter("otc");if(!IsNull($v_0)&&Mscrm.EntityPropUtil.isActivityTypeCode(parseInt($v_0,10))){var $v_1=$p0.GetParameter("otn");if(!IsNull($v_1))$p1.get_query()["type"]=$v_1}};Mscrm.GridRibbonActions.sendBulkEmail=function(gridControl,recordIds,entityTypeCode,totalRecordCount){if(recordIds.length>0){var $v_0={};$v_0["TotalRecords"]=totalRecordCount;$v_0["SelectedRecords"]=recordIds.length;$v_0["Ids"]=recordIds;$v_0["GridXml"]=gridControl.get_gridXml();var $v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_bulkemail.aspx");$v_1.get_query()["bulkemail"]="true";$v_1.get_query()["multiPage"]="false";$v_1.get_query()["objectTypeCode"]=entityTypeCode;openStdDlg($v_1,$v_0,600,600)}else alert(window.LOCID_EMAIL_NORECORDS_MSG)};Mscrm.GridRibbonActions.webMailMerge=function(gridControl,recordIds,entityTypeCode,totalRecordCount){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(recordIds.length>0){var $v_0={};$v_0["TotalRecords"]=totalRecordCount;$v_0["SelectedRecords"]=recordIds.length;$v_0["Ids"]=recordIds;$v_0["GridXml"]=gridControl.get_gridXml();var $v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_webmailmerge.aspx");$v_1.get_query()["objectTypeCode"]=entityTypeCode;openStdDlg($v_1,$v_0,600,600)}else alert(window.LOCID_ACTION_NOITEMSELECTED)};Mscrm.GridRibbonActions.addNewFromSubGridStandard=function(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl){if(Mscrm.EntityPropUtil.isActivityTypeCode(gridTypeCode)&&gridTypeCode!==Mscrm.EntityTypeCode.ActivityPointer&&gridTypeCode!==Mscrm.EntityTypeCode.CampaignActivity&&gridTypeCode!==Mscrm.EntityTypeCode.CampaignResponse&&!IsNull(primaryControl)){var $v_0=primaryControl.get_selectedRecords()[0];Mscrm.AddActivity.addActivityToObject(gridTypeCode,null,$v_0)}else if(parentEntityTypeCode===Mscrm.EntityTypeCode.Opportunity&&(gridTypeCode===Mscrm.EntityTypeCode.Quote||gridTypeCode===Mscrm.EntityTypeCode.SalesOrder||gridTypeCode===Mscrm.EntityTypeCode.Invoice)){var $v_1=-1;switch(gridTypeCode){case Mscrm.EntityTypeCode.SalesOrder:$v_1=21;break;case Mscrm.EntityTypeCode.Quote:$v_1=22;break;case Mscrm.EntityTypeCode.Invoice:$v_1=23;break}var $v_2=window.parent.customAddRelatedItem;if(IsNull($v_2))$v_2=customAddRelatedItem;$v_2($v_1)}else if(gridTypeCode===Mscrm.EntityTypeCode.KbArticle){gridTypeCode=Mscrm.EntityTypeCode.NewKbArticle;locAddRelatedToNonForm(gridTypeCode,parentEntityTypeCode,parentEntityId,"")}else locAddRelatedToNonForm(gridTypeCode,parentEntityTypeCode,parentEntityId,"")};Mscrm.GridRibbonActions.addExistingFromSubGridStandard=function(gridTypeCode,gridControl){Mscrm.Grid.addExistingFromSubGridStandard(gridTypeCode,gridControl,0,null)};Mscrm.GridRibbonActions.addExistingFromSubGridAssociated=function(gridTypeCode,gridControl){Mscrm.Grid.addExistingFromSubGridAssociated(gridTypeCode,gridControl,0,null)};Mscrm.GridRibbonActions.gridDisassociate=function(typeCode,gridControl){if(!IsNull(gridControl)){var $v_0="associationName={0}&roleOrd={1}",$v_1=gridControl.GetParameter("relName"),$v_2=gridControl.GetParameter("roleOrd");$v_0=String.format($v_0,CrmEncodeDecode.CrmUrlEncode($v_1),CrmEncodeDecode.CrmUrlEncode($v_2));var $v_3=$get("crmFormSubmit");if($v_3)doActionEx(gridControl.get_id(),typeCode,$v_3.crmFormSubmitId.value,"disassociate",$v_3.crmFormSubmitObjectType.value,$v_0);else doActionEx(gridControl.get_id(),typeCode,window.parent.$get("crmFormSubmit").crmFormSubmitId.value,"disassociate",window.parent.$get("crmFormSubmit").crmFormSubmitObjectType.value,$v_0)}};Mscrm.GridRibbonActions.enableWorkflowOnGrid=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.GetParameter("isWorkflowSupported");if($v_0.toUpperCase()==="TRUE")return true}return false};Mscrm.GridRibbonActions.launchOnDemandWorkflow=function(gridControl,records,entityTypeCode,workflowId){var $v_0=workflowId,$v_1=new Array(records.length);if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}for(var $v_2=true,$v_3=0;$v_3<records.length&&$v_2;$v_3++){if(records[$v_3].TypeCode!==records[0].TypeCode)$v_2=false;$v_1[$v_3]=records[$v_3].Id}if(!$v_2){alert(window.LOCID_HETEROGENOUS_TYPES);return}if(isNullOrEmptyString(workflowId)){var $v_4=[entityTypeCode,records,$v_1],$v_5=Mscrm.Utilities.createCallbackFunctionObject("setObjectIdAndRunWorkflow",Mscrm.GridRibbonActions,$v_4),$v_6=LookupObjectsWithCallback($v_5,null,"single","4703",0,null,"membertypecode="+CrmEncodeDecode.CrmUrlEncode(records[0].TypeCode.toString()),0,1,false,"","","","45102185-B1B4-422B-A3BF-F1BA9C6E130A",null,null,null,null,null,null,null,null,"{45102185-B1B4-422B-A3BF-F1BA9C6E130A}");Mscrm.Utilities.isModalDialogSupported()&&Mscrm.GridRibbonActions.setObjectIdAndRunWorkflow($v_6,entityTypeCode,records,$v_1);return}Mscrm.GridRibbonActions.runWorkflow($v_0,entityTypeCode,records,$v_1)};Mscrm.GridRibbonActions.setObjectIdAndRunWorkflow=function(lookupItems,entityTypeCode,records,ids){var $v_0;if(IsNull(lookupItems)||!lookupItems.items.length)return;$v_0=lookupItems.items[0].id;Mscrm.GridRibbonActions.runWorkflow($v_0,entityTypeCode,records,ids);return};Mscrm.GridRibbonActions.runWorkflow=function(itemObjectId,entityTypeCode,records,ids){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_runworkflow.aspx");$v_0.get_query()["iObjType"]=entityTypeCode;$v_0.get_query()["iTotal"]=records.length;$v_0.get_query()["wfId"]=itemObjectId;openStdDlg($v_0,ids,500,200)};Mscrm.GridRibbonActions.runScript=function(records,objectTypeCode){if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(records.length>1){alert(window.LOCID_GRID_TOO_MANY_RECORDS_IWF);return}var $v_0=[records],$v_1=Mscrm.Utilities.createCallbackFunctionObject("runDialog",Mscrm.GridRibbonActions,$v_0),$v_2=LookupObjectsWithCallback($v_1,null,"single","4703",0,null,"membertypecode="+CrmEncodeDecode.CrmUrlEncode(records[0].TypeCode.toString()),0,0,false,"","","","5DC43D17-D871-4470-B9D7-5B64AC2AF436",null,null,null,null,null,null,null,null,"{5DC43D17-D871-4470-B9D7-5B64AC2AF436}");Mscrm.Utilities.isModalDialogSupported()&&Mscrm.GridRibbonActions.runDialog($v_2,records)};Mscrm.GridRibbonActions.runDialog=function(lookupItems,records){if(!IsNull(lookupItems))if(0!==lookupItems.items.length){var $v_0=lookupItems.items[0].id,$v_1=records[0],$v_2=$v_1.Id,$v_3=Mscrm.CrmUri.create("/cs/dialog/rundialog.aspx");$v_3.get_query()["DialogId"]=$v_0;$v_3.get_query()["ObjectId"]=$v_2;$v_3.get_query()["EntityName"]=records[0].TypeName;openStdWin($v_3,buildWinName(null),615,480,null)}};Mscrm.GridRibbonActions.openSelectedRecordInNewWindow=function(selectedRecords){var $v_0=selectedRecords[0],$v_1={};$v_1["etc"]=$v_0.TypeCode;$v_1["id"]=$v_0.Id;$v_1["pagetype"]="entityrecord";$v_1["newWindow"]=true;var $v_2=Mscrm.PageManager.get_instance();if(!IsNull($v_2)){var $v_3=$v_2.get_eventManager();!IsNull($v_3)&&$v_3.raiseEvent(Mscrm.ScriptEvents.NavigateRequest,$v_1,null)}};Mscrm.GridRibbonActions.exportToExcel=function(gridControl,entityTypeCode){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}Mscrm.ExportGridToExcel.doExportToExcel(gridControl,entityTypeCode)};Mscrm.GridRibbonActions.runReport=function(commandProperties,gridControl,recordIds){Mscrm.RunReportFromGrid.runReport(commandProperties,gridControl,recordIds)};Mscrm.GridRibbonActions.runReportFromAppGrid=function(gridControl,recordIds,filterable,reportId,reportType,fileName){Mscrm.RunReportFromGrid.$R(gridControl,recordIds,filterable,reportId,reportType,fileName)};Mscrm.GridRibbonActions.print=function(gridControl){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}Mscrm.PrintFromGrid.print(gridControl)};Mscrm.GridRibbonActions.addCustomerRelationship=function(gridControl,selectedRecords,entityTypeCode){if(IsNull(selectedRecords)||!selectedRecords.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(selectedRecords.length===1)locAddRelatedToNonForm(Mscrm.EntityTypeCode.CustomerRelationship,entityTypeCode,selectedRecords[0].Id,"");else alert(window.LOCID_RELATIONSHIPS_TOO_MANY)};Mscrm.GridRibbonActions.addCustomerOpportunityRole=function(gridControl,selectedRecords,entityTypeCode){if(IsNull(selectedRecords)||!selectedRecords.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(selectedRecords.length===1)locAddRelatedToNonForm(Mscrm.EntityTypeCode.CustomerOpportunityRole,entityTypeCode,selectedRecords[0].Id,"");else alert(window.LOCID_RELATIONSHIPS_TOO_MANY)};Mscrm.GridRibbonActions.reclassify=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("reclassify",entityTypeCode,selectedRecords.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords)};Mscrm.GridRibbonActions.isContractInvoiced=function(){if(IsNull(window.CONTRACT_INVOICED))return false;else return window.CONTRACT_INVOICED};Mscrm.GridRibbonActions.$0=function($p0,$p1,$p2){return Mscrm.Grid.generateStandardActionUri($p0,$p1,$p2)};Mscrm.GridRibbonActions.$1=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){return Mscrm.Grid.executeStandardAction($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7)};Mscrm.GridRibbonActions.$I=function($p0,$p1,$p2,$p3,$p4,$p5){return Mscrm.Grid.executeStandardActionInternal($p0,$p1,$p2,$p3,$p4,$p5)};Mscrm.GridRibbonActions.$H=function($p0){var $v_0=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=3E4792DF-42CC-4b6b-B7E6-E197B4986EFF");$v_0=Mscrm.CrmUri.updateCrmUriHostAndScheme($v_0);var $v_1=parseInt(window.LOCID_DEDUPE_WINDOW_WIDTH,10),$v_2=parseInt(window.LOCID_DEDUPE_WINDOW_HEIGHT,10);openStdDlg($v_0,$p0,$v_1,$v_2)};Mscrm.GridRibbonActions.$L=function($p0){return Mscrm.Grid.getSubTypesString($p0)};Mscrm.GridRibbonActions.$8=function($p0){for(var $v_0=$p0.children.length-1;$v_0>=0;$v_0--)$p0.removeChild($p0.children[$v_0])};Mscrm.GridRibbonActions.$2=function($p0,$p1,$p2){var $v_0=document.createElement("input");$v_0.type="hidden";$v_0.name=$p1;$v_0.value=$p2;$p0.appendChild($v_0)};Mscrm.GridRibbonActions.$N=function($p0){var $v_0=$p0.GetParameter("isFetchXmlNotFinal");if(!isNullOrEmptyString($v_0))return !Mscrm.Utilities.parseBoolean($v_0);return false};Mscrm.GridRibbonActions.$P=function($p0){switch($p0){case "{C147F1F7-1D78-4D10-85BF-7E03B79F74FA}":case "{CFBCD7AF-AEE5-4E45-8ECC-C040D4020581}":case "{9818766E-7172-4D59-9279-013835C3DECD}":case "{927E6CD8-B3ED-4C20-A154-B8BD8A86D172}":case "{AFE23D8A-6651-474D-B8EE-90210A8231F6}":case "{FE961BBB-E5EA-44BA-AFF3-DB1D8BBBA18B}":return true}return false};Mscrm.GridRibbonActions.$d=function($p0){switch($p0){case "{ED1F0041-4F6B-4171-8757-4AC44C2FCAFA}":case "{8FBA639E-CD73-DF11-805D-00155DB1891A}":case "{A2927069-E4DC-4E8F-8FB1-D2F6C40C427E}":case "{8EF40D37-0868-440C-AF6B-CAC0C62E78E3}":case "{D234426E-1F37-4944-9255-50E19B541C4C}":case "{5E586DB6-222A-4ea3-8BD0-A85EE0FF52C3}":case "{DA5750D5-60A6-4ac7-A58A-A90CD2B1AF0A}":case "{AB582FB0-A846-453e-AD88-77F75CE91264}":case "{974C65FE-C789-48fe-B510-7AE579B9B5C6}":case "{6DFBA3A1-6DF3-4140-831B-B385C7E92B64}":case "{EF3CDB5B-71ED-4e73-92B2-ED6D47156521}":case "{F33B0C61-C5A9-4881-8275-C2DC63626251}":case "{B69375FB-61EF-433e-A4C2-031856F9A9E5}":case "{2EF7FF1D-8CCD-4422-86C4-4A48FE1F4B1D}":case "{634739A8-D8E5-41bb-B7DF-C121BD18E4B4}":case "{8DD58E14-0138-47d4-BA2D-A7DC76094D05}":case "{A596FF84-88FD-4eea-84F6-335B357E176A}":case "{31DAE384-A86F-DF11-986C-00155D2E3002}":case "{0894C803-4B27-DF11-893C-00155D26C21D}":case "{0E24F0D5-C2E1-4B3D-9F43-E9C817C811DF}":case "{01053369-B068-DF11-AE90-00155D2E3002}":case "{9C60DC64-4B27-DF11-893C-00155D26C21D}":case "{61F1B589-3DAF-45E1-96BF-9BF7B12AF252}":case "{2AAE0E9A-29A7-440D-8DD4-6FD37B8A156F}":case "{00000000-0000-0000-00AA-000010001028}":case "{460F1FAD-2673-DF11-986C-00155D2E3002}":case "{2D5E1400-F86D-DF11-986C-00155D2E3002}":case "{00000000-0000-0000-00AA-000010001021}":case "{00000000-0000-0000-00AA-000010001027}":case "{45B0D1D8-8D57-DF11-A5A2-00155D2A9005}":case "{8735625E-5657-DF11-A5A2-00155D2A9005}":return true}return false};Mscrm.PrintFromGrid=function(){};Mscrm.PrintFromGrid.print=function($p0){var $v_0=Mscrm.PrintFromGrid.$Z($p0);if(!IsNull($v_0)&&$v_0!==-1){var $v_1=Mscrm.CrmUri.create("/_grid/print/print.aspx").toString(),$v_2="print"+buildWinName($p0.GetParameter("viewid")),$v_3="status=1,resizable=1,scrollbars=0",$v_4=780,$v_5=500;if(isOutlookHostedWindow()){var $v_6="gridXml="+CrmEncodeDecode.CrmUrlEncode($p0.get_gridXml());$v_6+="&printAllPages="+CrmEncodeDecode.CrmUrlEncode($v_0.toString());PostToNewWindow($v_1,$v_2,$v_4,$v_5,$v_3,$v_6)}else{openStdWin(Mscrm.CrmUri.create(""),$v_2,$v_4,$v_5,$v_3);var $v_7=Mscrm.PrintFromGrid.$X($v_0,$p0.get_gridXml());$v_7.action=$v_1;$v_7.target=$v_2;$v_7.submit()}}};Mscrm.PrintFromGrid.$Z=function($p0){var $v_0=$p0.get_hasMorePages()||$p0.get_pageNumber()>1;if(!$v_0)return 0;var $v_1=Mscrm.CrmUri.create("/_grid/print/print_dlg.aspx");return openStdDlg($v_1,null,parseInt(window.LOCID_PRINT_WINDOW_WIDTH,10),parseInt(window.LOCID_PRINT_WINDOW_HEIGHT,10))};Mscrm.PrintFromGrid.$X=function($p0,$p1){var $v_0=document.getElementsByName("gridPrint")[0];if(!IsNull($v_0))Mscrm.GridRibbonActions.$8($v_0);else{$v_0=window.document.createElement("form");$v_0.setAttribute("name","gridPrint");$v_0.setAttribute("method","post");$v_0.style.display="none";window.document.body.appendChild($v_0)}Mscrm.GridRibbonActions.$2($v_0,"gridXml",$p1);Mscrm.GridRibbonActions.$2($v_0,"printAllPages",$p0.toString());return $v_0};Mscrm.RibbonActions=function(){};Mscrm.RibbonActions.$6=function($p0,$p1){if(IsNull($p0))return false;try{if(!IsNull($p0[$p1])){$p0[$p1]();return true}else if(Sys.UI.Control.isInstanceOfType($p0)){var $v_0=$get($p0.get_id());$v_0[$p1]();return true}}catch($$e_3){}return false};Mscrm.RibbonActions.$M=function($p0,$p1){if(IsNull($p0))return false;try{$p0[$p1]();return true}catch($$e_2){}return false};Mscrm.RibbonActions.print=function(primaryControl,selectedControl){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(!Mscrm.RibbonActions.$6(primaryControl,"Print"))if(!IsNull(selectedControl))Mscrm.RibbonActions.$6(selectedControl,"Print");else{var $v_0=document.getElementsByTagName("iframe");if($v_0&&$v_0.length>0)try{var $v_1=$v_0[0].contentWindow,$v_2=$v_1.Sys.Application.findComponent("crmGrid");if($v_2)$v_2.Print();else alert(window.LOCID_ACTION_UNSUPPORTED_ERROR)}catch($$e_5){alert(window.LOCID_ACTION_UNSUPPORTED_ERROR);return}}};Mscrm.RibbonActions.openAdvancedFind=function(selectedControl,primaryControl,newMode){var $v_0=true;if(IsNull(primaryControl)&&!IsNull(selectedControl)&&!newMode){var $v_1=$find(selectedControl.get_id()+"_filterSet");if(!IsNull($v_1)&&$v_1.isFilterSetDirty())$v_0=confirm(window.LOCID_GF_AFWARNING)}if($v_0)try{if(!IsNull(primaryControl)&&Mscrm.FormControl.isInstanceOfType(primaryControl))primaryControl.openAdvancedFind();else{var $v_2=$find("crmContentPanel");if($v_2&&Mscrm.ContentPanel.isInstanceOfType($v_2))$v_2.get_contentWindow().openAdvFind();else{var $v_3="crmGrid";if(!IsNull(selectedControl))$v_3=selectedControl.get_id();openAdvFind($v_3,newMode)}}}catch($$e_7){var $v_4=Mscrm.CrmUri.create("/main.aspx");$v_4.get_query()["pagetype"]="advancedfind";openStdWin($v_4,"_blank",700,600,null)}};Mscrm.RibbonActions.exportToExcel=function(gridControl){Mscrm.RibbonActions.$6(gridControl,"ExportToExcel")};Mscrm.RibbonActions.saveForm=function(form){var $v_0="Save";if(Mscrm.FormProxyForRibbon.isInstanceOfType(form)){form=form.get_crmFormControl();Mscrm.RibbonActions.$M(form,$v_0);return}Mscrm.RibbonActions.$6(form,$v_0)};Mscrm.RibbonActions.saveAndCloseForm=function(form){var $v_0="SaveAndClose";if(Mscrm.FormProxyForRibbon.isInstanceOfType(form)){form=form.get_crmFormControl();Mscrm.RibbonActions.$M(form,$v_0);return}Mscrm.RibbonActions.$6(form,$v_0)};Mscrm.RibbonActions.saveAndNewForm=function(form){var $v_0;if(Mscrm.FormProxyForRibbon.isInstanceOfType(form)){form=form.get_crmFormControl();$v_0=form}else if(isInstanceOfTypeAcrossFrames(form,Mscrm.FormControl))$v_0=form;else $v_0=$find("crmForm");try{$v_0.SubmitCrmForm(59,true,true,false,false)}catch($$e_2){}};Mscrm.RibbonActions.closeForm=function(form){Mscrm.RibbonActions.$6(form,"CloseRecord")};Mscrm.RibbonActions.addActivityOnForm=function(activityTypeCode){Mscrm.AddActivity.addActivityToForm(activityTypeCode,null)};Mscrm.RibbonActions.addNoteToRecord=function(parentTypeCode,parentId){openObjEx(Mscrm.EntityTypeCode.Annotation,parentTypeCode,parentId)};Mscrm.RibbonActions.addFileToRecord=function(parentTypeCode,parentId){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.Annotation),$v_1=$v_0.Url;$v_1.get_query()["hideDesc"]="1";$v_1.get_query()["pId"]=parentId;$v_1.get_query()["pType"]=parentTypeCode;openStdWin($v_1,buildWinName(),500,175,null)};Mscrm.RibbonActions.openSettings=function(){var $v_0=Mscrm.CrmUri.create("/tools/personalsettings/dialogs/personalsettings.aspx");openStdDlg($v_0,null,950,695)&&Mscrm.Utilities.reloadPage()};Mscrm.RibbonActions.close=function(){var $v_0=Mscrm.ScriptEvents.NavigateClose;if(Mscrm.NavigationMode.DefaultNavigationMode===Mscrm.NavigationMode.NavigationModeInline)$v_0=Mscrm.ScriptEvents.NavigateBackCheckpoint;Mscrm.PageManager.get_instance().raiseEvent($v_0,null)};Mscrm.RibbonActions.sendFormShortcut=function(usingEmail,form){if(!usingEmail&&!Mscrm.Utilities.get_ieBrowserVersion()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=null;if(isInstanceOfTypeAcrossFrames(form,Mscrm.FormControl))$v_0=form.get_primaryFieldValue();try{Mscrm.FormAction.sendFormShortcut(usingEmail,$v_0)}catch($$e_3){}};Mscrm.RibbonActions.addPrimaryToMarketingList=function(typeCode){doAction(null,typeCode,"addtolist",$get("crmFormSubmit").crmFormSubmitId.value)};Mscrm.RibbonActions.submitPrimary=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"submit",null)};Mscrm.RibbonActions.approvePrimary=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"approve",null)};Mscrm.RibbonActions.unpublishPrimary=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"unpublish",null)};Mscrm.RibbonActions.articleView=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"articleview",null)};Mscrm.RibbonActions.approveEmail=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"approve_user",null)};Mscrm.RibbonActions.rejectEmail=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"reject_user",null)};Mscrm.RibbonActions.showVisualization=function(gridControl,toggleVisualization){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if($v_2.isChartEnabled()&&$v_2.isGridEnabled())if(!IsNull($v_2)){$v_2.showVisualization(toggleVisualization);refreshRibbon()}}};Mscrm.RibbonActions.hideVisualization=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if($v_2.isChartEnabled()&&$v_2.isGridEnabled())if(!IsNull($v_2)){$v_2.hideVisualization();refreshRibbon()}}};Mscrm.RibbonActions.applyChartType=function(chartType){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.applyChartType(chartType,false)};Mscrm.RibbonActions.applyTopBottom=function(isTop,count){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.appendTopBottom(count.toString(),isTop,false,true)};Mscrm.RibbonActions.applyTopBottomCustom=function(isTop){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.appendTopBottomCustom(isTop,false)};Mscrm.RibbonActions.clearTopBottom=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.clearTopBottom()};Mscrm.RibbonActions.closeDesigner=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)){$v_0.showVisualizationPane();$v_0.exitDesigner()}};Mscrm.RibbonActions.saveVisualization=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.saveVisualization()};Mscrm.RibbonActions.saveAndCloseVisualization=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.saveAndCloseVisualization()};Mscrm.RibbonActions.copyVisualization=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.saveChart(true)};Mscrm.RibbonActions.editVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.switchMode(Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode)};Mscrm.RibbonActions.createNewVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.switchMode(Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode)};Mscrm.RibbonActions.importVisualization=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))$v_0.importVisualization();else Mscrm.VisualizationActions.importVisualization(Mscrm.EntityTypeCode.UserQueryVisualization)};Mscrm.RibbonActions.exportVisualization=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.exportVisualization()};Mscrm.RibbonActions.refreshVisualization=function(domEvent){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)){$v_0.showVisualizationPane(false);$v_0.refreshVisualizationPane(domEvent)}};Mscrm.RibbonActions.changeCompositeControlLayout=function(selectedEntityTypeCode,gridControl,layoutMode){var $v_0=false;if(!Mscrm.PageManager.isFlatUIPage()&&!($v_0=Mscrm.PageManager.isOutlookProxyPage()))return;if(!IsNull(gridControl)){var $v_1=false,$v_2=gridControl.get_id()+"_visualizationCompositeControl",$v_3=$find($v_2);if(layoutMode!==parseInt($v_3.get_compositeLayout(),10))$v_1=true;var $v_4=gridControl.get_id()+"_paneControl",$v_5=$find($v_4);if(!$v_1&&!$v_0){if(IsNull($v_5)||!$v_5.isVisualizationPaneVisible())Mscrm.RibbonActions.showVisualization(gridControl,false);else $v_5.getParameter("paneSize")===Mscrm.VisualizationPaneMode.collapsedSize&&$v_5.showVisualizationPane();return}if(!IsNull($v_5)&&$v_5.isPaneInDesignerMode()&&!$v_5.confirmCloseDesigner())return;var $v_6=Mscrm.Utilities.getContentUrl(null);if(Mscrm.EntityPropUtil.isActivityTypeCode(selectedEntityTypeCode))$v_6.get_query()["type"]=gridControl.GetParameter("otn");var $v_7=layoutMode.toString(),$v_8=$v_3.getVisualizationPaneParameter("CurrentVisualizationId"),$v_9=$v_3.getVisualizationPaneParameter("CurrentVisualizationType"),$v_A=Mscrm.RibbonActions.$c($v_4),$v_B=$v_A===Mscrm.VisualizationPaneMode.none||$v_A===Mscrm.VisualizationPaneMode.collapsedSize?Mscrm.VisualizationPaneMode.defaultSize:$v_A;$v_6.get_query()["layout"]=$v_7;$v_6.get_query()["visualizationId"]=$v_8;$v_6.get_query()["visualizationType"]=$v_9;$v_6.get_query()["visualizationPaneMode"]=$v_B;var $v_C=$v_3.getVisualizationPaneParameter("vizPaneViewId"),$v_D=$v_3.getVisualizationPaneParameter("vizPaneViewType");if(!isNullOrEmptyString($v_D)&&!isNullOrEmptyString($v_C)){delete $v_6.get_query().viewId;delete $v_6.get_query().viewType;$v_6.get_query()["viewid"]=$v_C;$v_6.get_query()["viewtype"]=$v_D}var $v_E={};$v_E["uri"]=$v_6.toString();$v_E["name"]=buildWinName(null);var $v_F=Mscrm.VisualizationActions.createVizParamsDictionary($v_7,$v_8,$v_9,$v_B,$v_3.getVisualizationPaneParameter("vizPanePrimaryEntityName"),$v_3.getVisualizationPaneParameter("IsDashboardComponent"));Mscrm.VisualizationActions.fireEventForStickyVisualization($v_F);if($v_0)if($v_1)getOutlookHostedWindow().changeVisualizationLayout(!layoutMode);else getOutlookHostedWindow().showVisualization(true);Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.NavigateRequest,$v_E)}};Mscrm.RibbonActions.assignVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.assignVisualization()};Mscrm.RibbonActions.shareVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.shareVisualizations()};Mscrm.RibbonActions.$c=function($p0){var $v_0=$find($p0);if(!IsNull($v_0))if(!isNullOrEmptyString($v_0.getParameter("paneSize"))){var $v_1=$v_0.getParameter("paneSize").toString();if($v_1===Mscrm.VisualizationPaneMode.resizeMode)$v_1=Mscrm.VisualizationPaneMode.defaultSize;return $v_1}return Mscrm.VisualizationPaneMode.none};Mscrm.RibbonActions.showChartLayoutQuery=function(commandProperties,gridControl,layoutMode){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))if($v_1.isVisualizationPaneVisible())commandProperties["On"]=layoutMode===$v_1.getParameter("compositeLayout");else commandProperties["On"]=false}};Mscrm.RibbonActions.showVisualizationQuery=function(commandProperties,gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))commandProperties["On"]=$v_1.isVisualizationPaneOpen();else commandProperties["On"]=false}};Mscrm.RibbonActions.visualizationOffQuery=function(commandProperties,gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))commandProperties["On"]=!$v_1.isVisualizationPaneVisible();else commandProperties["On"]=true}};Mscrm.RibbonActions.deleteVisualization=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);!IsNull($v_1)&&$v_1.deleteVisualization()}};Mscrm.RibbonActions.addRelatedToNonForm=function(relatedTypeCode,primaryTypeCode){locAddRelatedToNonForm(relatedTypeCode,primaryTypeCode,$get("crmFormSubmit").crmFormSubmitId.value,"")};Mscrm.RibbonActions.addRelatedAddress=function(relatedTypeCode){AddRelatedAddress(relatedTypeCode,$get("crmFormSubmit").crmFormSubmitObjectType.value,$get("crmFormSubmit").crmFormSubmitId.value)};Mscrm.RibbonActions.addFormToMarketingList=function(primaryTypeCode){doAction(null,primaryTypeCode,"addtolist",$get("crmFormSubmit").crmFormSubmitId.value)};Mscrm.RibbonActions.openFormProperties=function(id,objectTypeCode){var $v_0=Mscrm.CrmUri.create("/_forms/properties/properties.aspx");$v_0.get_query()["id"]=id;$v_0.get_query()["objTypeCode"]=objectTypeCode;openStdDlg($v_0,"tmp",420,505,true,false,null)};Mscrm.RibbonActions.openHelpLegalLink=function(){safeWindowOpen(Mscrm.CrmUri.create(window.CRM_ONLINE_LEGAL_LINK),"MSCRMLegal","width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1",true)};Mscrm.RibbonActions.openHelpPrivacyLink=function(){safeWindowOpen(Mscrm.CrmUri.create(window.CRM_ONLINE_PRIVACY_LINK),"MSCRMPrivacy","width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1",true)};Mscrm.RibbonActions.goTo=function(areaId,groupId,subareaId){try{window.top.goTo(areaId,groupId,subareaId)}catch($$e_3){window.goTo(areaId,groupId,subareaId)}};Mscrm.RibbonActions.runReportFromFormRibbon=function(commandProperties,control){var $v_0=commandProperties["SourceControlId"],$v_1=$v_0.substr($v_0.length-38),$v_2=Mscrm.ReportUtil.get_reportInformation()[$v_1];control.RunReport($v_2.Filterable,$v_1,$v_2.ReportType,$v_2.FileName)};Mscrm.RibbonActions.addConnectionFromForm=function(objectId,objectTypeCode,primaryControl,connectToMe){var $v_0=String.format("pId={0}&pType={1}",CrmEncodeDecode.CrmNameValueEncode(objectId),CrmEncodeDecode.CrmNameValueEncode(objectTypeCode.toString()));if(connectToMe)$v_0=String.format("{0}&connectToMe=true",$v_0);openObj(Mscrm.EntityTypeCode.Connection,"",$v_0,null,Mscrm.NavigationMode.NavigationModeNewWindow,null)};Mscrm.RibbonActions.addConnectionFromFormWithEntityTitle=function(objectId,objectTypeCode,primaryControl,connectToMe){Mscrm.RibbonActions.addConnectionFromForm(objectId,objectTypeCode,primaryControl,connectToMe)};Mscrm.RibbonActions.openEntityEditor=function(selEntityTypeCode,primEntityTypeCode){var $v_0=selEntityTypeCode;if(!$v_0)$v_0=primEntityTypeCode;var $v_1=String.format("def_category={0}&def_type={1}",Mscrm.EntityTypeCode.Entity,$v_0);openObj(Mscrm.EntityTypeCode.Solution,window.DEF_SOL_ID,$v_1)};Mscrm.RibbonActions.designView=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.GetParameter("otc");if(!isNullOrEmptyString($v_0)){var $v_1=Mscrm.FormEditor.getEntityId(parseInt($v_0,10)),$v_2=String.format("entityId={0}",$v_1);openObj(Mscrm.EntityTypeCode.SavedQuery,gridControl.GetParameter("viewid"),$v_2)}else openObj(Mscrm.EntityTypeCode.SavedQuery,gridControl.GetParameter("viewid"))}};Mscrm.RibbonActions.createSystemView=function(selEntityTypeCode){var $v_0=String.format("objectTypeCode={0}",selEntityTypeCode);openObj(Mscrm.EntityTypeCode.SavedQuery,"",$v_0)};Mscrm.RibbonActions.manageViews=function(selEntityTypeCode){var $v_0=String.format("def_category={0}&def_type={1}&def_subcat={2}",Mscrm.EntityTypeCode.Entity,selEntityTypeCode,"view");openObj(Mscrm.EntityTypeCode.Solution,window.DEF_SOL_ID,$v_0)};Mscrm.RibbonActions.refreshGrid=function(gridControl){!IsNull(gridControl)&&gridControl.refresh()};Mscrm.RibbonActions.createPersonalView=function(selectedControl){Mscrm.RibbonActions.openAdvancedFind(selectedControl,null,true)};Mscrm.RibbonActions.alwaysEnabled=function(){return true};Mscrm.RibbonActions.neverEnabled=function(){return false};Mscrm.RibbonActions.enableExportToExcel=function(){return true};Mscrm.RibbonActions.enableWorkflowOnForm=function(){if(!IsNull(window.IS_WORKFLOWENABLED_FORM)&&window.IS_WORKFLOWENABLED_FORM)return true;return false};Mscrm.RibbonActions.hasSecuredFields=function(){if(!IsNull(window.HAS_SECURED_FIELDS))return window.HAS_SECURED_FIELDS;return false};Mscrm.RibbonActions.canCustomizeVisualization=function(){if(!IsNull(window.CAN_CUSTOMIZE_VISUALIZATION))return window.CAN_CUSTOMIZE_VISUALIZATION;return false};Mscrm.RibbonActions.gridFiltersToggle=function(gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_0)){$v_0.ToggleFilters();refreshRibbon()}}};Mscrm.RibbonActions.gridFiltersQuery=function(commandProperties,gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_0))commandProperties["On"]=$v_0.IsFilterEnabled()}};Mscrm.RibbonActions.gridFiltersSaveAsNewView=function(gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");!IsNull($v_0)&&$v_0.Save(true)}};Mscrm.RibbonActions.gridFiltersSaveToCurrentView=function(gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");!IsNull($v_0)&&$v_0.Save(false)}};Mscrm.RibbonActions.saveAsDefaultGridView=function(){setDefaultView()};Mscrm.RibbonActions.isSystemQuerySelected=function(gridControl){return !Mscrm.RibbonActions.isUserQuerySelected(gridControl)};Mscrm.RibbonActions.isUserQuerySelected=function(gridControl){if(Mscrm.PageManager.isOutlookProxyPage())return !Mscrm.RibbonActions.isSystemViewLoaded(gridControl);if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_SavedNewQuerySelector",$v_1=$find($v_0);if(!IsNull($v_1)&&$v_1.showNewVSControl&&!$v_1.showOriginalSelectBox){var $v_3=parseInt($v_1.selectedViewType,10);return Mscrm.EntityTypeCode.UserQuery===$v_3}$v_0=gridControl.get_id()+"_SavedQuerySelector";var $v_2=$get($v_0);if(!IsNull($v_2)){var $v_4=$v_2.options[$v_2.selectedIndex],$v_5=$v_4.Type;if(!IsNull($v_5)&&parseInt($v_5,10)===Mscrm.EntityTypeCode.UserQuery)return true}}return false};Mscrm.RibbonActions.isUserQueryVisualizationSelected=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))if($v_0.isVisualizationPaneVisible()){var $v_1=$v_0.getPaneChildElement("visualizationList");if($v_0.get_visualizationType()===Mscrm.EntityTypeCode.UserQueryVisualization)return true}return false};Mscrm.RibbonActions.isDrilldownMode=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))return $v_0.checkIfDrilldownMode();return false};Mscrm.RibbonActions.isFormDesignValid=function(entityTypeCode){switch(entityTypeCode){case Mscrm.EntityTypeCode.ActivityPointer:return false;default:return true}};Mscrm.RibbonActions.isShareValid=function(entityTypeCode){switch(entityTypeCode){case Mscrm.EntityTypeCode.ActivityPointer:return false;default:return true}};Mscrm.RibbonActions.isBulkEditEnabledForEntity=function(entityTypeCode){switch(entityTypeCode){case Mscrm.EntityTypeCode.AccountAddress:case Mscrm.EntityTypeCode.ActivityMimeAttachment:case Mscrm.EntityTypeCode.ActivityParty:case Mscrm.EntityTypeCode.ActivityPointer:case Mscrm.EntityTypeCode.ActivityScheduling:case Mscrm.EntityTypeCode.Annotation:case Mscrm.EntityTypeCode.AnnualFiscalCalendar:case Mscrm.EntityTypeCode.ApplicationFile:case Mscrm.EntityTypeCode.AppLicense:case Mscrm.EntityTypeCode.AppOfflineFilter:case Mscrm.EntityTypeCode.Appointment:case Mscrm.EntityTypeCode.AppSalesPerson:case Mscrm.EntityTypeCode.AppWorkflowInstance:case Mscrm.EntityTypeCode.AsyncOperation:case Mscrm.EntityTypeCode.Attribute:case Mscrm.EntityTypeCode.AttributeMap:case Mscrm.EntityTypeCode.AttributePicklistValue:case Mscrm.EntityTypeCode.Audit:case Mscrm.EntityTypeCode.BulkDeleteFailure:case Mscrm.EntityTypeCode.BulkDeleteOperation:case Mscrm.EntityTypeCode.BulkDeleteWizardDialog:case Mscrm.EntityTypeCode.BulkOperation:case Mscrm.EntityTypeCode.BulkOperationLog:case Mscrm.EntityTypeCode.BusinessUnit:case Mscrm.EntityTypeCode.BusinessUnitMap:case Mscrm.EntityTypeCode.BusinessUnitNewsArticle:case Mscrm.EntityTypeCode.Calendar:case Mscrm.EntityTypeCode.CalendarRule:case Mscrm.EntityTypeCode.ClientUpdate:case Mscrm.EntityTypeCode.ColumnMapping:case Mscrm.EntityTypeCode.CompetitorAddress:case Mscrm.EntityTypeCode.Connection:case Mscrm.EntityTypeCode.ConnectionRole:case Mscrm.EntityTypeCode.ConstraintBasedGroup:case Mscrm.EntityTypeCode.ContactAddress:case Mscrm.EntityTypeCode.Contract:case Mscrm.EntityTypeCode.ContractDetail:case Mscrm.EntityTypeCode.ContractTemplate:case Mscrm.EntityTypeCode.CustomerAddress:case Mscrm.EntityTypeCode.CustomerOpportunityRole:case Mscrm.EntityTypeCode.CustomerRelationship:case Mscrm.EntityTypeCode.Discount:case Mscrm.EntityTypeCode.DiscountType:case Mscrm.EntityTypeCode.DisplayString:case Mscrm.EntityTypeCode.DisplayStringMap:case Mscrm.EntityTypeCode.DocumentIndex:case Mscrm.EntityTypeCode.DuplicateDetectionDialog:case Mscrm.EntityTypeCode.DuplicateRecord:case Mscrm.EntityTypeCode.DuplicateRule:case Mscrm.EntityTypeCode.DuplicateRuleCondition:case Mscrm.EntityTypeCode.Email:case Mscrm.EntityTypeCode.EmailHash:case Mscrm.EntityTypeCode.Entity:case Mscrm.EntityTypeCode.EntityMap:case Mscrm.EntityTypeCode.EntityRelationship:case Mscrm.EntityTypeCode.EntityRelationshipRole:case Mscrm.EntityTypeCode.Equipment:case Mscrm.EntityTypeCode.Fax:case Mscrm.EntityTypeCode.FieldPermission:case Mscrm.EntityTypeCode.FieldSecurityProfile:case Mscrm.EntityTypeCode.FilterTemplate:case Mscrm.EntityTypeCode.FixedMonthlyFiscalCalendar:case Mscrm.EntityTypeCode.GoalRollupQuery:case Mscrm.EntityTypeCode.HolidayCalendarRule:case Mscrm.EntityTypeCode.ImportData:case Mscrm.EntityTypeCode.ImportEntity:case Mscrm.EntityTypeCode.ImportFile:case Mscrm.EntityTypeCode.ImportJob:case Mscrm.EntityTypeCode.ImportLog:case Mscrm.EntityTypeCode.ImportMap:case Mscrm.EntityTypeCode.ImportWizardDialog:case Mscrm.EntityTypeCode.IncidentResolution:case Mscrm.EntityTypeCode.IntegrationStatus:case Mscrm.EntityTypeCode.InternalAddress:case Mscrm.EntityTypeCode.InterProcessLock:case Mscrm.EntityTypeCode.Invoice:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.IsvConfig:case Mscrm.EntityTypeCode.KbArticle:case Mscrm.EntityTypeCode.KbArticleComment:case Mscrm.EntityTypeCode.KbArticleTemplate:case Mscrm.EntityTypeCode.LeadAddress:case Mscrm.EntityTypeCode.Letter:case Mscrm.EntityTypeCode.License:case Mscrm.EntityTypeCode.ListMember:case Mscrm.EntityTypeCode.LocalizedLabel:case Mscrm.EntityTypeCode.LookUpMapping:case Mscrm.EntityTypeCode.MailMergeTemplate:case Mscrm.EntityTypeCode.Metric:case Mscrm.EntityTypeCode.MonthlyFiscalCalendar:case Mscrm.EntityTypeCode.NewKbArticle:case Mscrm.EntityTypeCode.None:case Mscrm.EntityTypeCode.Notification:case Mscrm.EntityTypeCode.NotWorkingWorkShift:case Mscrm.EntityTypeCode.OccurrenceCalendarRule:case Mscrm.EntityTypeCode.OccurringWorkShift:case Mscrm.EntityTypeCode.OpportunityClose:case Mscrm.EntityTypeCode.OpportunityProduct:case Mscrm.EntityTypeCode.OptionSet:case Mscrm.EntityTypeCode.OrderClose:case Mscrm.EntityTypeCode.Organization:case Mscrm.EntityTypeCode.OrganizationStatistic:case Mscrm.EntityTypeCode.OrganizationUI:case Mscrm.EntityTypeCode.OwnerMapping:case Mscrm.EntityTypeCode.PhoneCall:case Mscrm.EntityTypeCode.PickListMapping:case Mscrm.EntityTypeCode.PluginAssembly:case Mscrm.EntityTypeCode.PluginType:case Mscrm.EntityTypeCode.PluginTypeStatistic:case Mscrm.EntityTypeCode.Privilege:case Mscrm.EntityTypeCode.PrivilegeObjectTypeCodes:case Mscrm.EntityTypeCode.ProcessSession:case Mscrm.EntityTypeCode.ProductPriceLevel:case Mscrm.EntityTypeCode.Publisher:case Mscrm.EntityTypeCode.QuarterlyFiscalCalendar:case Mscrm.EntityTypeCode.Queue:case Mscrm.EntityTypeCode.QueueItem:case Mscrm.EntityTypeCode.QuoteClose:case Mscrm.EntityTypeCode.QuoteDetail:case Mscrm.EntityTypeCode.RecurrenceCalendarRule:case Mscrm.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.EntityTypeCode.RecurringWorkShift:case Mscrm.EntityTypeCode.Relationship:case Mscrm.EntityTypeCode.RelationshipRole:case Mscrm.EntityTypeCode.RelationshipRoleMap:case Mscrm.EntityTypeCode.Report:case Mscrm.EntityTypeCode.ReportPropertyDialog:case Mscrm.EntityTypeCode.ResourceGroupExpansion:case Mscrm.EntityTypeCode.ResourceSpec:case Mscrm.EntityTypeCode.RibbonCommand:case Mscrm.EntityTypeCode.RibbonContextGroup:case Mscrm.EntityTypeCode.RibbonCustomization:case Mscrm.EntityTypeCode.RibbonDiff:case Mscrm.EntityTypeCode.RibbonRule:case Mscrm.EntityTypeCode.RibbonTabToCommandMap:case Mscrm.EntityTypeCode.Role:case Mscrm.EntityTypeCode.RolePrivileges:case Mscrm.EntityTypeCode.RoleTemplate:case Mscrm.EntityTypeCode.RoleTemplatePrivileges:case Mscrm.EntityTypeCode.RollupField:case Mscrm.EntityTypeCode.SalesLiterature:case Mscrm.EntityTypeCode.SalesLiteratureItem:case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.SavedQuery:case Mscrm.EntityTypeCode.SavedQueryVisualization:case Mscrm.EntityTypeCode.ScriptErrorDetailsDialog:case Mscrm.EntityTypeCode.ScriptErrorDialog:case Mscrm.EntityTypeCode.SdkMessage:case Mscrm.EntityTypeCode.SdkMessageFilter:case Mscrm.EntityTypeCode.SdkMessagePair:case Mscrm.EntityTypeCode.SdkMessageProcessingStep:case Mscrm.EntityTypeCode.SdkMessageProcessingStepImage:case Mscrm.EntityTypeCode.SdkMessageProcessingStepSecureConfig:case Mscrm.EntityTypeCode.SdkMessageRequest:case Mscrm.EntityTypeCode.SdkMessageRequestField:case Mscrm.EntityTypeCode.SdkMessageResponse:case Mscrm.EntityTypeCode.SdkMessageResponseField:case Mscrm.EntityTypeCode.SemiAnnualFiscalCalendar:case Mscrm.EntityTypeCode.Service:case Mscrm.EntityTypeCode.ServiceAppointment:case Mscrm.EntityTypeCode.ServiceEndpoint:case Mscrm.EntityTypeCode.ServiceRestrictionCalendarRule:case Mscrm.EntityTypeCode.SharePointDocumentLocation:case Mscrm.EntityTypeCode.SharePointSite:case Mscrm.EntityTypeCode.Site:case Mscrm.EntityTypeCode.SiteMap:case Mscrm.EntityTypeCode.Solution:case Mscrm.EntityTypeCode.SolutionComponent:case Mscrm.EntityTypeCode.SolutionExportWizard:case Mscrm.EntityTypeCode.SolutionImportWizard:case Mscrm.EntityTypeCode.Subject:case Mscrm.EntityTypeCode.Subscription:case Mscrm.EntityTypeCode.SubscriptionClients:case Mscrm.EntityTypeCode.SubscriptionManuallyTrackedObject:case Mscrm.EntityTypeCode.SubscriptionSyncInfo:case Mscrm.EntityTypeCode.SystemForm:case Mscrm.EntityTypeCode.SystemUser:case Mscrm.EntityTypeCode.SystemUserPrincipals:case Mscrm.EntityTypeCode.Task:case Mscrm.EntityTypeCode.Team:case Mscrm.EntityTypeCode.Template:case Mscrm.EntityTypeCode.Territory:case Mscrm.EntityTypeCode.TimeOffCalendarRule:case Mscrm.EntityTypeCode.TimeZoneDefinition:case Mscrm.EntityTypeCode.TimeZoneLocalizedName:case Mscrm.EntityTypeCode.TimeZoneRule:case Mscrm.EntityTypeCode.TransactionCurrency:case Mscrm.EntityTypeCode.TransformationMapping:case Mscrm.EntityTypeCode.TransformationParameterMapping:case Mscrm.EntityTypeCode.UnresolvedAddress:case Mscrm.EntityTypeCode.UnresolvedEmailParty:case Mscrm.EntityTypeCode.UoM:case Mscrm.EntityTypeCode.UserFiscalCalendar:case Mscrm.EntityTypeCode.UserForm:case Mscrm.EntityTypeCode.UserQuery:case Mscrm.EntityTypeCode.UserQueryVisualization:case Mscrm.EntityTypeCode.UserSettings:case Mscrm.EntityTypeCode.ViewAttribute:case Mscrm.EntityTypeCode.WebResource:case Mscrm.EntityTypeCode.WebWizard:case Mscrm.EntityTypeCode.WizardAccessPrivilege:case Mscrm.EntityTypeCode.WizardPage:case Mscrm.EntityTypeCode.Workflow:case Mscrm.EntityTypeCode.WorkflowDependency:case Mscrm.EntityTypeCode.WorkflowLog:case Mscrm.EntityTypeCode.WorkflowWaitSubscription:return false;default:return true}};Mscrm.RibbonActions.isDeleteVisualizationEnabled=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))if($v_0.isVisualizationPaneVisible())if(Mscrm.RibbonActions.isUserQueryVisualizationSelected()&&!$v_0.isVisualizationListEmpty()&&!$v_0.checkIfDrilldownMode()&&!$v_0.isPaneInDesignerMode())return true;return false};Mscrm.RibbonActions.isSystemViewLoaded=function(gridControl){if(!IsNull(gridControl)&&gridControl.GetParameter("viewtype")===Mscrm.EntityTypeCode.SavedQuery.toString())return true;return false};Mscrm.RibbonActions.canEnableSaveButton=function(gridControl){try{if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_0))return $v_0.CanEnableFilters()&&$v_0.IsFilterEnabled()}}catch($$e_2){}return false};Mscrm.RibbonActions.canEnableFiltersOnGrid=function(gridControl){try{if(!IsNull(gridControl)){var $v_0=gridControl.GetParameter("enableFilters");if(isNullOrEmptyString($v_0)){var $v_1=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_1))return $v_1.CanEnableFilters()}else{gridControl.SetParameter("enableFilters","");return Mscrm.Utilities.parseBoolean($v_0)}}}catch($$e_3){}return false};Mscrm.RibbonActions.enableChartsButton=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if(!IsNull($v_2)&&!$v_2.enableChartButton())return false;return true}return false};Mscrm.RibbonActions.disableButtonsWhenChartMaximized=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))if($v_1.getParameter("paneSize")===Mscrm.VisualizationPaneMode.expandedSize)return false}return true};Mscrm.RibbonActions.enableSetDefaultGridViewButton=function(){var $v_0="crmGrid_SavedNewQuerySelector",$v_1=$find($v_0);if(!IsNull($v_1)&&$v_1.showNewVSControl&&!$v_1.showOriginalSelectBox)return $v_1.selectedViewId!==$v_1.quickFindQuery&&$v_1.selectedViewId!==$v_1.userSelectedDefaultView;var $v_2=$get($v_0);if(!IsNull($v_2)&&$v_2.DataValue!==window.LOCID_SEARCH_RESULTS){var $v_3=$v_2.options[$v_2.selectedIndex],$v_4=$v_3.getAttribute("isdefault");if(!isNullOrEmptyString($v_4)&&Boolean.parse($v_4))return false;else return true}return false};Mscrm.RibbonActions.faxFormHasSend=function(){return !IsNull(window.CRM_FAXFORM_SEND_ALLOWED)&&window.CRM_FAXFORM_SEND_ALLOWED};Mscrm.RibbonActions.enableAssignShareChartButton=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&!$v_0.isVisualizationListEmpty()){var $v_1=$v_0.get_visualizationId();if($v_0.get_visualizationType()===Mscrm.EntityTypeCode.UserQueryVisualization)return true}return false};Mscrm.RibbonActions.isOutlookExplorerOrInspector=function(){return isOutlookHostedWindow()&&getOutlookHostedWindow().ParentFrameAvailable};Mscrm.RibbonActions.enableRibbonOnSubGrid=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if(!IsNull($v_2))if(!$v_2.isGridEnabled())return false}return true};Mscrm.RibbonActions.showVisualizationToolsRibbon=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))return $v_0.isVisualizationPaneVisible()&&$v_0.isPaneInDesignerMode();else return false};Mscrm.RibbonActions.isVisualizationPaneInDesignerMode=function(){return Mscrm.RibbonActions.$O()};Mscrm.RibbonActions.isComplexChart=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))return $v_0.get_isComplexChart();return false};Mscrm.RibbonActions.isVisualizationPaneInRuntimeMode=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&!$v_0.isPaneInDesignerMode())return true;return false};Mscrm.RibbonActions.isVisualizationPaneInRuntimeOrEditMode=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&($v_0.get_paneMode()===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode||$v_0.get_paneMode()===Mscrm.VisualizationPaneRenderingModes.RuntimeMode))return true;return false};Mscrm.RibbonActions.isSaveAsChartEnabled=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()){if(Mscrm.RibbonActions.isVisualizationPaneInRuntimeMode()){if($v_0.checkIfDrilldownMode())return false;return !$v_0.isVisualizationListEmpty()}else if($v_0.get_paneMode()===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode)return false;return true}return false};Mscrm.RibbonActions.isDefaultVisualizationModule=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&!$v_0.isDefaultVisualizationModule())return false;return true};Mscrm.RibbonActions.isSaveChartEnabled=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&Mscrm.RibbonActions.$O())return true;return false};Mscrm.RibbonActions.isFetchxmlQuery=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&!$v_0.isCustomQuery())return true;return false};Mscrm.RibbonActions.$O=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.isPaneInDesignerMode())return true;return false};Mscrm.RibbonActions.isChartSelected=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&!$v_0.isVisualizationListEmpty())return true;return false};Mscrm.RibbonActions.isIEBrowser=function(){return Mscrm.Utilities.isIE()};Mscrm.RibbonActions.isIos=function(){return Mscrm.Utilities.isIosDevice()};Mscrm.RibbonActions.canApplyChartType=function(chartType){var $v_0=$find("crmGrid_paneControl");if($v_0)return $v_0.canApplyChartType(chartType);return false};Mscrm.RibbonActions.isTopBottomEnabled=function(){var $v_0=false,$v_1=$find("crmGrid_paneControl");if($v_1)$v_0=$v_1.isTopBottomEnabledForSelectedSeries();return $v_0};Mscrm.RibbonActions.primaryControlIsNotFormProxy=function(primaryControl){if(primaryControl&&Mscrm.FormProxyForRibbon)return !isInstanceOfTypeAcrossFrames(primaryControl,Mscrm.FormProxyForRibbon);return true};Mscrm.RibbonActions.formPageDeveloperTabEnableRule=function(primaryControl){if(Mscrm.Utilities.isUserUsingBaseLanguage())return Mscrm.RibbonActions.primaryControlIsNotFormProxy(primaryControl);else return false};Mscrm.RibbonActions.gridPageDeveloperTabEnableRule=function(){if(Mscrm.Utilities.isUserUsingBaseLanguage())return true;else return false};Mscrm.RibbonActions.canAttachFile=function(entityTypeCode){if(Mscrm.EntityTypeCode.ActivityPointer===entityTypeCode||Mscrm.EntityTypeCode.Email===entityTypeCode)return false;else return true};Mscrm.RibbonActions.enableAddCaseForContract=function(){if(!IsNull(window.ADDCASE_ENABLED_FOR_CONTRACT))return window.ADDCASE_ENABLED_FOR_CONTRACT;else return true};Mscrm.RibbonActions.enableAddCaseForContractLine=function(){if(!IsNull(window.ADDCASE_ENABLED_FOR_CONTRACTLINE))return window.ADDCASE_ENABLED_FOR_CONTRACTLINE;else return true};Mscrm.RibbonActions.enableCancelForContractLineSubGrid=function(){if(!IsNull(window.CONTRACT_INVOICED_OR_ACTIVE))return window.CONTRACT_INVOICED_OR_ACTIVE;else return false};Mscrm.RibbonActions.enableDeleteForContractLineSubGrid=function(){if(!IsNull(window.CONTRACT_DRAFT_OR_CANCEL_OR_EXPIRE))return window.CONTRACT_DRAFT_OR_CANCEL_OR_EXPIRE;else return false};Mscrm.RibbonActions.canPromoteActivityToResponse=function(){if(!IsNull(window.LOCID_PROMOTE_TO_RESPONSE))return window.LOCID_PROMOTE_TO_RESPONSE;else return false};Mscrm.RibbonActions.canPromoteEmailToResponse=function(){if(!IsNull(window.LOCID_PROMOTE_EMAIL_TO_RESPONSE))return window.LOCID_PROMOTE_EMAIL_TO_RESPONSE;else return false};Mscrm.RibbonActions.isServiceRefreshEnabled=function(){return Mscrm.FeatureControl.get_Current().isFeatureEnabled(Mscrm.FeatureNames.RefreshService)};Mscrm.RibbonActions.onTabSwitch=function(commandProperties){raiseTabSwitchEvent(commandProperties)};Mscrm.RibbonActions.onRootEvent=function(commandProperties){raiseRibbonRootEvent(commandProperties)};Mscrm.RunReportFromGrid=function(){};Mscrm.RunReportFromGrid.runReport=function(commandProperties,gridControl,recordIds){var $v_0=commandProperties["SourceControlId"],$v_1=$v_0.substr($v_0.length-38),$v_2=Mscrm.ReportUtil.get_reportInformation()[$v_1],$v_3=$v_2.Filterable,$v_4=$v_2.ReportType,$v_5=$v_2.FileName;Mscrm.RunReportFromGrid.$R(gridControl,recordIds,$v_3,$v_1,$v_4,$v_5)};Mscrm.RunReportFromGrid.$R=function($p0,$p1,$p2,$p3,$p4,$p5){var $v_0=2,$v_1=$p0.GetParameter("effectiveFetchXml");if($p2){var $v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_runreport.aspx");$v_2.get_query()["id"]=$p3;$v_2.get_query()["numselected"]=$p1.length;$v_2.get_query()["enableview"]=Mscrm.GridRibbonActions.$N($p0)?"1":"0";var $v_3=[$p0,$p1,$p2,$p3,$p4,$p5,$v_1],$v_4=Mscrm.Utilities.createCallbackFunctionObject("performActionAfterRunReport",Mscrm.RunReportFromGrid,$v_3);$v_0=openStdDlgWithCallback($v_2,null,450,400,$v_4);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.RunReportFromGrid.performActionAfterRunReport($v_0,$p0,$p1,$p2,$p3,$p4,$p5,$v_1)}else Mscrm.RunReportFromGrid.performActionAfterRunReport($v_0,$p0,$p1,$p2,$p3,$p4,$p5,$v_1)};Mscrm.RunReportFromGrid.performActionAfterRunReport=function(runMode,gridControl,recordIds,filterable,reportId,reportType,fileName,fetchXml){if(filterable)if(IsNull(runMode))runMode=-1;if(runMode===-1)return;var $v_0=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.Report),$v_1=$v_0.Url,$v_2,$v_3=null;switch(runMode){case 1:$v_2=Mscrm.RunReportFromGrid.$G($v_1,reportId,fileName,"fetch");if(isOutlookHostedWindow())$v_3="fetchxml="+CrmEncodeDecode.CrmUrlEncode(fetchXml)+"\n\n";else Mscrm.GridRibbonActions.$2($v_2,"fetchxml",fetchXml);break;case 0:for(var $v_4=new Sys.StringBuilder,$v_6=0;$v_6<recordIds.length;$v_6++){$v_6>0&&$v_4.append(";");$v_4.append(recordIds[$v_6])}$v_2=Mscrm.RunReportFromGrid.$G($v_1,reportId,fileName,"records","recordstype="+CrmEncodeDecode.CrmUrlEncode(gridControl.GetParameter("otc")));if(isOutlookHostedWindow())$v_3="records="+CrmEncodeDecode.CrmUrlEncode($v_4.toString())+"\n\n";else Mscrm.GridRibbonActions.$2($v_2,"records",$v_4.toString());break;case 2:default:Mscrm.ReportUtil.viewReport(reportType,reportId,fileName,"run",null);return}var $v_5=buildWinName(null);if(isOutlookHostedWindow())PostToNewWindow($v_2.action,$v_5,$v_0.Width,$v_0.Height,null,$v_3);else{openStdWin(Mscrm.CrmUri.create("/_static/loading.htm"),$v_5,$v_0.Width,$v_0.Height,null);$v_2.target=$v_5;$v_2.submit()}};Mscrm.RunReportFromGrid.$G=function($p0,$p1,$p2,$p3,$p4){var $v_0=document.getElementsByName("gridViewReport")[0];if(!IsNull($v_0))Mscrm.GridRibbonActions.$8($v_0);else{$v_0=window.document.createElement("form");$v_0.setAttribute("name","gridViewReport");$v_0.setAttribute("method","post");$v_0.setAttribute("style","display: none");$v_0=window.document.body.appendChild($v_0)}$p0.get_query()["action"]="run";$p0.get_query()["id"]=$p1;$p0.get_query()["helpID"]=$p2;if(!IsNull($p3))$p0.get_query()["context"]=$p3;!IsNull($p4)&&$p0.appendToQuery("&"+$p4);$v_0.action=$p0.toString();return $v_0};Mscrm.ExportDialogArguments.registerClass("Mscrm.ExportDialogArguments");Mscrm.ExportDialogReturnValue.registerClass("Mscrm.ExportDialogReturnValue");Mscrm.DetectDuplicateArguments.registerClass("Mscrm.DetectDuplicateArguments");Mscrm.TeamActions.registerClass("Mscrm.TeamActions");Mscrm.UserQueryActions.registerClass("Mscrm.UserQueryActions");Mscrm.Campaign.registerClass("Mscrm.Campaign");Mscrm.IncidentActions.registerClass("Mscrm.IncidentActions");Mscrm.Article.registerClass("Mscrm.Article");Mscrm.ImportFileActions.registerClass("Mscrm.ImportFileActions");Mscrm.List.registerClass("Mscrm.List");Mscrm.QueueItem.registerClass("Mscrm.QueueItem");Mscrm.QuickCampaign.registerClass("Mscrm.QuickCampaign");Mscrm.ReportActions.registerClass("Mscrm.ReportActions");Mscrm.Goal.registerClass("Mscrm.Goal");Mscrm.LeadActions.registerClass("Mscrm.LeadActions");Mscrm.OpportunityActions.registerClass("Mscrm.OpportunityActions");Mscrm.RollupField.registerClass("Mscrm.RollupField");Mscrm.SalesLiterature.registerClass("Mscrm.SalesLiterature");Mscrm.SystemUserActions.registerClass("Mscrm.SystemUserActions");Mscrm.ExportGridToExcel.registerClass("Mscrm.ExportGridToExcel");Mscrm.DashboardRibbonActions.registerClass("Mscrm.DashboardRibbonActions");Mscrm.DashboardEditorRibbonActions.registerClass("Mscrm.DashboardEditorRibbonActions");Mscrm.GridRibbonActions.registerClass("Mscrm.GridRibbonActions");Mscrm.PrintFromGrid.registerClass("Mscrm.PrintFromGrid");Mscrm.RibbonActions.registerClass("Mscrm.RibbonActions");Mscrm.RunReportFromGrid.registerClass("Mscrm.RunReportFromGrid");Mscrm.UserQueryActions._queryTargetTypeCode=Mscrm.EntityTypeCode.None;Mscrm.UserQueryActions.$7=null;Mscrm.IncidentActions.$E="{4a63c8d1-6c1e-48ec-9db4-3e6c7155334c}";Mscrm.DashboardRibbonActions.$5=null;Mscrm.DashboardRibbonActions.$9="/main.aspx?pagetype=dashboardeditor";Mscrm.DashboardRibbonActions.$B=window.screen.availWidth*.9;Mscrm.DashboardRibbonActions.$A=window.screen.availHeight*.9