<html> 
<head> 
<title>Fetch 2011 JavaScript Example</title> 
<link rel="stylesheet" type="text/css" href="/_common/styles/theme.css.aspx" /> 
<link rel="stylesheet" type="text/css" href="/_common/styles/global.css.aspx" /> 
<link rel="stylesheet" type="text/css" href="/_common/styles/fonts.css.aspx" /> 
<link rel="stylesheet" type="text/css" href="/_common/styles/Dialogs.css.aspx" />

<script src="ClientGlobalContext.js.aspx"></script> 

    <script src="new_scripts/new_FetchUtil.js" type="text/javascript"></script>

<script type="text/javascript">

    var _oService;
    var _sOrgName = "";
    var _sServerUrl = GetGlobalContext().getServerUrl();

    function executeFetchCommand() {

        var sFetch = document.getElementById('txtFetch').value;
        _oService = new FetchUtil(_sOrgName, _sServerUrl);
        var oEntity = _oService.Fetch(sFetch, myCallBack);
    }


    function myCallBack(results) {
        var sOut = "";
        sOut += "<b>XML Response</b><br />";
        sOut += results;
        document.getElementById('dvData').innerHTML = sOut;
    } 

</script>

</head> 
<body> 
<table style="width: 100%; height: 100%;" cellspacing="0" cellpadding="0" border="0"> 
<tr> 
<td class="ms-crm-Dialog-Header" id="tdDialogHeader"> 
<div id="divTitle" class="ms-crm-Dialog-Header-Title">Executing Fetch from JavaScript in CRM 2011</div>
<div id="divInstructions" class="ms-crm-Dialog-Header-Desc">Enter some FetchXML to be executed against your CRM environment</div> 
</td> 
</tr> 
<tr> 
<td style="height: 100%;"> 
<div class="ms-crm-Dialog-Main" style="padding: 14px;"> 
<label>Fetch Command</label><br /> 
<textarea id="txtFetch" rows="8" width="100%" cols="100" ></textarea><br /> 
<input type="Submit" value="Fetch" onClick="javascript:executeFetchCommand();" style="width:100px;height:24px;"> 
<div id='dvData' style="width: 100%; height: 100%;"></div> 
</div> 
</td> 
</tr> 
<tr> 
<td class="ms-crm-Dialog-Footer" id="tdDialogFooter"> 
<table cellspacing="0" cellpadding="0"> 
<tr> 
<td width="100%"></td> 
<td>&nbsp;<button onclick="window.close();" class="ms-crm-Button">Done</button></td> 
</tr> 
</table> 
</td> 
</tr> 
</table>

</body> 
</html>

 